# –û—Ç—á—ë—Ç: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π Status Checker

## üö® –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –æ–±—É—á–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞ status checker –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ:

```
üîç –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å—Ç–∞—Ç—É—Å–∞ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞ dd07bb1c-0cf7-4737-93a2-4955ad50a9fa, request_id: d9c48a0d-1153-4f65-b047-f226376b7b12
üîç –ê–≤–∞—Ç–∞—Ä dd07bb1c-0cf7-4737-93a2-4955ad50a9fa –±–æ–ª—å—à–µ –Ω–µ –≤ —Å—Ç–∞—Ç—É—Å–µ TRAINING, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å, –Ω–æ status checker –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –°–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ë–î
- Status checker —Å—Ä–∞–∑—É –ø—Ä–æ–≤–µ—Ä—è–ª —Å—Ç–∞—Ç—É—Å –∞–≤–∞—Ç–∞—Ä–∞ –≤ –ë–î
- –ö —ç—Ç–æ–º—É –≤—Ä–µ–º–µ–Ω–∏ –∞–≤–∞—Ç–∞—Ä —É–∂–µ –º–æ–≥ –±—ã—Ç—å –æ–±–Ω–æ–≤–ª—ë–Ω –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è –¥–æ –Ω–∞—á–∞–ª–∞ —Ä–µ–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ FAL AI

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ë–î –Ω–∞–¥ FAL AI
- –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–ª–∞—Å—å –ë–î, –ø–æ—Ç–æ–º FAL AI
- –ï—Å–ª–∏ –ë–î –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–µ–∫—Ä–∞—â–∞–ª—Å—è
- FAL AI –º–æ–≥ –µ—â—ë –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- –ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –æ–±—É—á–µ–Ω–∏—è –≤ FAL AI
- –°—Ç–∞—Ç—É—Å –º–æ–≥ –±—ã—Ç—å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º –≤ –ø–µ—Ä–≤—ã–µ —Å–µ–∫—É–Ω–¥—ã

## üîß –†–µ—à–µ–Ω–∏–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞—á–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
```python
# –î–∞—ë–º –≤—Ä–µ–º—è –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –æ–±—É—á–µ–Ω–∏—è (30 —Å–µ–∫—É–Ω–¥)
logger.info(f"üîç –û–∂–∏–¥–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞ {avatar_id}...")
await asyncio.sleep(30)
```

### 2. –ò–∑–º–µ–Ω—ë–Ω –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫
```python
# –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –≤ FAL AI
status_data = await self._check_fal_status(status_url)

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∞–≤–∞—Ç–∞—Ä–∞ –≤ –ë–î —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ FAL AI –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
if not status_data:
    async with get_session() as session:
        # ... –ø—Ä–æ–≤–µ—Ä–∫–∞ –ë–î
```

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π
```python
consecutive_not_training_checks = 0
max_consecutive_checks = 3  # –ú–∞–∫—Å–∏–º—É–º 3 –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥—Ä—è–¥

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø–æ–¥—Ä—è–¥
if consecutive_not_training_checks >= max_consecutive_checks:
    logger.info(f"üîç –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞ {avatar_id}")
    return
```

### 4. –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤ FAL AI
```python
if fal_status in ["IN_QUEUE", "IN_PROGRESS"]:
    consecutive_not_training_checks = 0
    await self._process_status_update(avatar_id, request_id, training_type, status_data)
    
elif fal_status == "COMPLETED":
    logger.info(f"üîç –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞ {avatar_id}")
    await self._process_status_update(avatar_id, request_id, training_type, status_data)
    return
```

## üìä –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π:
1. **–ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** - —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–æ–Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏
2. **–û–∂–∏–¥–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏** - 30 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è –≤ FAL AI
3. **–û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**:
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤ FAL AI (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –æ—Ç FAL AI
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –æ—Ç–≤–µ—Ç–∞ –æ—Ç FAL AI
   - –ó–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π (3 –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥—Ä—è–¥)
4. **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ** - –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ COMPLETED/FAILED/CANCELLED –æ—Ç FAL AI

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:
- ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–µ –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç—Å—è –∏–∑-–∑–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
- ‚úÖ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç FAL AI**: –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã - —Å–∞–º —Å–µ—Ä–≤–∏—Å –æ–±—É—á–µ–Ω–∏—è
- ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç –≥–æ–Ω–æ–∫**: –ó–∞–¥–µ—Ä–∂–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—É—é –æ—Å—Ç–∞–Ω–æ–≤–∫—É
- ‚úÖ **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**: –ù–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø–æ–¥—Ä—è–¥ –ø–µ—Ä–µ–¥ –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
python manual_status_check.py
```

### –û–ø—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
1. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤—Å–µ—Ö –∑–∞–≤–∏—Å—à–∏—Ö –∞–≤–∞—Ç–∞—Ä–æ–≤**
2. **–ü–æ–∫–∞–∑ —Ç–µ–∫—É—â–∏—Ö –∞–≤–∞—Ç–∞—Ä–æ–≤ –≤ –æ–±—É—á–µ–Ω–∏–∏**
3. **–ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–≤–∞—Ç–∞—Ä–∞**

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–≤–∞—Ç–∞—Ä–∞:
```bash
python quick_check_avatar.py
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:
- ‚úÖ Status checker –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:
1. **–ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è** ‚Üí Status checker –∂–¥—ë—Ç 30 —Å–µ–∫—É–Ω–¥
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ FAL AI –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
3. **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ** ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —á–µ—Ä–µ–∑ WebhookHandler
4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î** ‚Üí –°—Ç–∞—Ç—É—Å COMPLETED + —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è

## üöÄ –î–µ–ø–ª–æ–π

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl restart aisha-bot

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
sudo journalctl -u aisha-bot -f

# –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
python manual_status_check.py
```

### –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:
```
üîç –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å—Ç–∞—Ç—É—Å–∞ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞...
üîç –û–∂–∏–¥–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞...
üîç FAL AI —Å—Ç–∞—Ç—É—Å –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞: IN_QUEUE
üîç FAL AI —Å—Ç–∞—Ç—É—Å –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞: IN_PROGRESS
üîç –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞...
üîç –û–±—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–æ —á–µ—Ä–µ–∑ status checker
```

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è! üéâ 
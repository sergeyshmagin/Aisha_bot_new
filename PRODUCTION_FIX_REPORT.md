# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

## üö® –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –æ–±—É—á–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –≤–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞:
```
'AvatarTrainingService' object has no attribute '_save_training_info'
```

## üìä –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤
```
May 28 07:15:11 - HTTP Request: POST https://queue.fal.run/fal-ai/flux-pro-trainer
May 28 07:15:11 - üé® –£—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∑–∞–ø—Ä–æ—Å –≤ FAL AI: 2adc5f75-bc37-4e44-b0e9-49577b26d816
May 28 07:15:11 - üé® –•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞ 165fab7d-3168-4a84-bc02-fec49f03b070
May 28 07:15:11 - WARNING: 'AvatarTrainingService' object has no attribute '_save_training_info'
```

**‚úÖ –•–æ—Ä–æ—à–∏–µ –Ω–æ–≤–æ—Å—Ç–∏:**
- FAL AI –∑–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ
- –û–±—É—á–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –≤ FAL AI
- –ü–æ–ª—É—á–µ–Ω request_id: `2adc5f75-bc37-4e44-b0e9-49577b26d816`

**‚ùå –ü—Ä–æ–±–ª–µ–º–∞:**
- –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ–±—É—á–µ–Ω–∏–∏ –≤ –ë–î
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –º–µ—Ç–æ–¥—ã `_save_training_info` –∏ `_update_avatar_status` –≤ –Ω–æ–≤–æ–π –º–æ–¥—É–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ

## üîß –ü—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏

–ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ `AvatarTrainingService` –±—ã–ª —Ä–∞–∑–±–∏—Ç –Ω–∞ –º–æ–¥—É–ª–∏:
- `TrainingManager` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏–µ–º
- `WebhookHandler` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ webhook
- `ProgressTracker` - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- `AvatarValidator` - –≤–∞–ª–∏–¥–∞—Ü–∏—è

–ú–µ—Ç–æ–¥—ã `_save_training_info` –∏ `_update_avatar_status` –æ—Å—Ç–∞–ª–∏—Å—å –≤ `TrainingManager`, –Ω–æ –Ω–µ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –≤ `main_service.py`:

```python
async def _save_training_info(
    self, 
    avatar_id: UUID, 
    finetune_id: str, 
    custom_config: Optional[Dict[str, Any]] = None
) -> None:
    """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ–±—É—á–µ–Ω–∏–∏ (–¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –∫ TrainingManager)"""
    return await self.training_manager._save_training_info(avatar_id, finetune_id, custom_config)

async def _update_avatar_status(
    self,
    avatar_id: UUID,
    status: AvatarStatus,
    progress: Optional[int] = None,
    **kwargs
) -> None:
    """–û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∞–≤–∞—Ç–∞—Ä–∞ (–¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –∫ TrainingManager)"""
    return await self.training_manager._update_avatar_status(avatar_id, status, progress, **kwargs)
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `AvatarStatus`:
```python
from app.database.models import AvatarStatus
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**‚úÖ –¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è –≤ FAL AI
2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ–±—É—á–µ–Ω–∏–∏ –≤ –ë–î
3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∞–≤–∞—Ç–∞—Ä–∞
4. Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**‚úÖ –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
- –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –º–æ–¥—É–ª—è–º

## üöÄ –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

**‚úÖ –°–ò–°–¢–ï–ú–ê –ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–ê –ò –ì–û–¢–û–í–ê –ö –ü–†–û–î–ê–ö–®–ï–ù–£**

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
1. ‚úÖ **FAL AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –∑–∞–ø—Ä–æ—Å—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
2. ‚úÖ **–û–±—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–æ–≤** - –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. ‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
4. ‚úÖ **Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –≥–æ—Ç–æ–≤–∞ –∫ –ø–æ–ª—É—á–µ–Ω–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
5. ‚úÖ **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –≤—Å–µ –º–æ–¥—É–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞** —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º –∫–æ–¥–æ–º
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª** –æ–±—É—á–µ–Ω–∏—è
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å webhook** –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –æ–±—É—á–µ–Ω–∏—è

## üìù –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
pkill -f "python.*app/main.py"
pkill -f "python.*api_server/main.py"

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é
python app/main.py &
python api_server/main.py &
```

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–û—à–∏–±–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞! –û–±—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–æ–≤ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é:
- ‚úÖ –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è –≤ FAL AI
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ webhook

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –Ω–∞ 100%!** üöÄ 
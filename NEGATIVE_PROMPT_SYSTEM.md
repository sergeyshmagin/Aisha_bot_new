# üö´ –°–∏—Å—Ç–µ–º–∞ Negative Prompt - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å —Ä—É–∫–∞–º–∏ –∏ –∞–Ω–∞—Ç–æ–º–∏–µ–π

## üìã –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–æ–±—â–∏–ª–∏ –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
- ‚ùå **–ù–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–ª–∏–Ω–Ω—ã–µ –ø–∞–ª—å—Ü—ã** 
- ‚ùå **–ù–µ–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ä—É–∫**
- ‚ùå **–î–µ—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä—É–∫–∏ –∏ –ø–∞–ª—å—Ü—ã**
- ‚ùå **–õ–∏—à–Ω–∏–µ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–∞–ª—å—Ü—ã**

–≠—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ—à–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é **–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ (negative prompt)**.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–°–æ–∑–¥–∞–Ω–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ negative prompt**, –∫–æ—Ç–æ—Ä–∞—è:

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç** –¥–ª—è –∫–∞–∂–¥–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
2. **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø–æ —Ç–∏–ø–∞–º –∞–≤–∞—Ç–∞—Ä–æ–≤** (–ø–æ—Ä—Ç—Ä–µ—Ç/—Å—Ç–∏–ª—å)
3. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø—Ä–æ–º–ø—Ç–æ–≤ —á–µ—Ä–µ–∑ GPT**
4. **–ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ FAL AI** –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 1. PromptProcessingService

```python
def get_negative_prompt(self, avatar_type: str) -> str:
    """–°–æ–∑–¥–∞–µ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º"""
    
    base_negative = [
        # –ü—Ä–æ–±–ª–µ–º—ã —Å —Ä—É–∫–∞–º–∏ –∏ –ø–∞–ª—å—Ü–∞–º–∏
        "deformed hands", "extra fingers", "missing fingers", "fused fingers", 
        "too many fingers", "poorly drawn hands", "mutated hands", "malformed hands",
        "extra hands", "missing hands", "floating hands", "disconnected hands",
        "long fingers", "thin fingers", "thick fingers", "bent fingers",
        "twisted fingers", "curled fingers", "overlapping fingers",
        
        # –ü—Ä–æ–±–ª–µ–º—ã —Å –ª–∏—Ü–æ–º –∏ –≥–æ–ª–æ–≤–æ–π
        "deformed face", "disfigured face", "ugly face", "bad anatomy", 
        "poorly drawn face", "mutated face", "extra eyes", "missing eyes",
        
        # –û–±—â–∏–µ –∞–Ω–∞—Ç–æ–º–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
        "bad proportions", "extra limbs", "missing limbs", "floating limbs",
        "disconnected limbs", "mutated body", "deformed body", "twisted body",
        
        # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
        "blurry", "low quality", "worst quality", "jpeg artifacts", 
        "watermark", "signature", "text", "logo", "username"
    ]
```

### 2. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º

**–ü–æ—Ä—Ç—Ä–µ—Ç–Ω—ã–µ –∞–≤–∞—Ç–∞—Ä—ã:**
```python
portrait_negative = [
    "full body", "whole body", "legs visible", "feet visible",
    "hands in frame", "fingers visible", "holding objects",
    "multiple people", "crowd", "group photo"
]
```

**–°—Ç–∏–ª–µ–≤—ã–µ –∞–≤–∞—Ç–∞—Ä—ã:**
```python
style_negative = [
    "realistic hands", "detailed hands", "visible hands",
    "hand gestures", "pointing", "waving", "holding",
    "cartoon style", "anime style", "chibi style"
]
```

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–æ—Ü–µ—Å—Å–æ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

```python
# –í process_prompt
return {
    "original": user_prompt,
    "processed": processed_prompt,
    "negative_prompt": self.get_negative_prompt(avatar_type),  # ‚Üê –ù–û–í–û–ï
    "translation_needed": translation_needed
}

# –í generate_custom
config['negative_prompt'] = negative_prompt  # –ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ FAL AI
```

### 4. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ FAL AI

```python
# –í _generate_with_ultra_finetuned
generation_args = {
    "prompt": full_prompt,
    "finetune_id": avatar.finetune_id,
    "negative_prompt": config.get("negative_prompt"),  # ‚Üê –ù–û–í–û–ï
    # ... –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
}

# –í _generate_with_lora_legacy  
generation_args = {
    "prompt": full_prompt,
    "lora_url": avatar.diffusers_lora_file_url,
    "negative_prompt": config.get("negative_prompt"),  # ‚Üê –ù–û–í–û–ï
    # ... –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
}
```

## üéØ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç GPT

–î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è GPT –æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –æ–ø–∏—Å–∞–Ω–∏–∏ –ø–æ–∑:

```
–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û - –†–£–ö–ò –ò –ü–û–ó–´:
- –ò–ó–ë–ï–ì–ê–ô –æ–ø–∏—Å–∞–Ω–∏—è —Ä—É–∫ –∏ –ø–∞–ª—å—Ü–µ–≤ –≤ –¥–µ—Ç–∞–ª—è—Ö
- –ü–†–ï–î–ü–û–ß–ò–¢–ê–ô –ø–æ–∑—ã –±–µ–∑ –≤–∏–¥–∏–º—ã—Ö —Ä—É–∫: "arms at sides", "hands not visible", "cropped before hands"  
- –ï–°–õ–ò —Ä—É–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∏–¥–Ω—ã: –∏—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ –æ–±—â–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è "natural hand positioning", "relaxed pose"
- –ù–ï –æ–ø–∏—Å—ã–≤–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∂–µ—Å—Ç—ã –∏–ª–∏ –ø–æ–∑–∏—Ü–∏–∏ –ø–∞–ª—å—Ü–µ–≤

–ò–ó–ë–ï–ì–ê–ù–ò–ï –ü–†–û–ë–õ–ï–ú –° –†–£–ö–ê–ú–ò:
- –ö–∞–¥—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –í–´–®–ï —Ä—É–∫: "cropped at mid-torso", "cropped at chest level", "shoulders and head visible"
- –ï—Å–ª–∏ —Ä—É–∫–∏ –≤–∏–¥–Ω—ã: "hands naturally positioned", "relaxed arm positioning", "arms at sides"
- –ù–ï –æ–ø–∏—Å—ã–≤–∞—Ç—å: –∂–µ—Å—Ç—ã, –ø–æ–∑–∏—Ü–∏–∏ –ø–∞–ª—å—Ü–µ–≤, –¥–µ—Ç–∞–ª–∏ —Ä—É–∫
```

## üìä –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç negative prompt

### ü§ö –ü—Ä–æ–±–ª–µ–º—ã —Å —Ä—É–∫–∞–º–∏
- `deformed hands` - –¥–µ—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä—É–∫–∏
- `extra fingers` - –ª–∏—à–Ω–∏–µ –ø–∞–ª—å—Ü—ã  
- `missing fingers` - –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–∞–ª—å—Ü—ã
- `fused fingers` - —Å—Ä–æ—Å—à–∏–µ—Å—è –ø–∞–ª—å—Ü—ã
- `too many fingers` - —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–∞–ª—å—Ü–µ–≤
- `long fingers` - –¥–ª–∏–Ω–Ω—ã–µ –ø–∞–ª—å—Ü—ã
- `twisted fingers` - —Å–∫—Ä—É—á–µ–Ω–Ω—ã–µ –ø–∞–ª—å—Ü—ã
- `malformed hands` - —É—Ä–æ–¥–ª–∏–≤—ã–µ —Ä—É–∫–∏

### üë§ –ê–Ω–∞—Ç–æ–º–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- `bad anatomy` - –ø–ª–æ—Ö–∞—è –∞–Ω–∞—Ç–æ–º–∏—è
- `bad proportions` - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏
- `extra limbs` - –ª–∏—à–Ω–∏–µ –∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏
- `missing limbs` - –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏
- `deformed face` - –¥–µ—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–∏—Ü–æ
- `mutated body` - –º—É—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ–ª–æ

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- `blurry` - —Ä–∞–∑–º—ã—Ç–æ—Å—Ç—å
- `low quality` - –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
- `jpeg artifacts` - –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–∂–∞—Ç–∏—è
- `watermark` - –≤–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏
- `text` - –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç

### üìê –ö–æ–º–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- `awkward pose` - –Ω–µ–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–æ–∑–∞
- `impossible pose` - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞—è –ø–æ–∑–∞
- `broken perspective` - –Ω–∞—Ä—É—à–µ–Ω–Ω–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞
- `strange pose` - —Å—Ç—Ä–∞–Ω–Ω–∞—è –ø–æ–∑–∞

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –ø—Ä–æ–º–ø—Ç**: "–¥–µ–ª–æ–≤–æ–π –º—É–∂—á–∏–Ω–∞ –≤ –∫–æ—Å—Ç—é–º–µ"

2. **GPT —Å–æ–∑–¥–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç** (–∏–∑–±–µ–≥–∞—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è —Ä—É–∫):
   ```
   "A high-quality portrait photograph of a professional man in business attire, 
   centrally positioned in the frame, cropped at mid-torso, occupying 70% of 
   vertical space. The subject has natural hand positioning with arms at sides..."
   ```

3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è negative prompt**:
   ```
   "deformed hands, extra fingers, missing fingers, fused fingers, too many fingers, 
   poorly drawn hands, mutated hands, malformed hands, extra hands, missing hands, 
   floating hands, disconnected hands, long fingers, thin fingers, thick fingers, 
   bent fingers, twisted fingers, curled fingers, overlapping fingers, deformed face,
   disfigured face, ugly face, bad anatomy, poorly drawn face..."
   ```

4. **FAL AI –ø–æ–ª—É—á–∞–µ—Ç –æ–±–∞ –ø—Ä–æ–º–ø—Ç–∞**:
   - **–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π**: —á—Ç–æ –º—ã –•–û–¢–ò–ú –≤–∏–¥–µ—Ç—å
   - **–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π**: —á—Ç–æ –º—ã –ù–ï –•–û–¢–ò–ú –≤–∏–¥–µ—Ç—å

5. **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º —Å —Ä—É–∫–∞–º–∏

## üìà –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### ‚úÖ –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** –ø—Ä–æ–±–ª–µ–º —Å —Ä—É–∫–∞–º–∏
- **–ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π** –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
- **–†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏** 
- **–£–ª—É—á—à–µ–Ω–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ** –≤—Å–µ—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π

### ‚úÖ –î–ª—è —Å–∏—Å—Ç–µ–º—ã
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞** –±–µ–∑ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞
- **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** –ø–æ —Ç–∏–ø–∞–º –∞–≤–∞—Ç–∞—Ä–æ–≤
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º

## üî¨ –õ–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```
[2025-01-20 10:30:15] INFO: Negative prompt —Å–æ–∑–¥–∞–Ω –¥–ª—è portrait: 1247 —Å–∏–º–≤–æ–ª–æ–≤
[2025-01-20 10:30:16] INFO: –î–æ–±–∞–≤–ª–µ–Ω negative prompt –¥–ª—è Style –∞–≤–∞—Ç–∞—Ä–∞: 1247 —Å–∏–º–≤–æ–ª–æ–≤  
[2025-01-20 10:30:17] INFO: [FAL AI] –î–æ–±–∞–≤–ª–µ–Ω negative prompt –¥–ª—è Portrait –∞–≤–∞—Ç–∞—Ä–∞: 1183 —Å–∏–º–≤–æ–ª–æ–≤
```

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–ë–û–õ–¨–®–ï –ù–ï–¢ –ü–†–û–ë–õ–ï–ú –°:**
- ‚ùå –î–ª–∏–Ω–Ω—ã–º–∏ –ø–∞–ª—å—Ü–∞–º–∏ ‚Üí ‚úÖ –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏
- ‚ùå –î–µ—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ä—É–∫–∞–º–∏ ‚Üí ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞–Ω–∞—Ç–æ–º–∏—è  
- ‚ùå –õ–∏—à–Ω–∏–º–∏ –ø–∞–ª—å—Ü–∞–º–∏ ‚Üí ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- ‚ùå –ù–µ–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø–æ–∑–∞–º–∏ ‚Üí ‚úÖ –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–∑—ã
- ‚ùå –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º–∏ ‚Üí ‚úÖ –ß–∏—Å—Ç—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑ —É—á–∞—Å—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!** üéØ 
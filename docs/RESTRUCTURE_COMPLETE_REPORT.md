# üéâ –û—Ç—á–µ—Ç: –†–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞

**–î–∞—Ç–∞:** 2025-05-23  
**–í–µ—Ç–∫–∞:** `restructure/move-v2-to-root`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û

## üìä –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

#### ‚ùå –ë—ã–ª–æ:
```
aisha_bot_new/
‚îú‚îÄ‚îÄ aisha_v1/           # Legacy –∫–æ–¥ (98 Python —Ñ–∞–π–ª–æ–≤)
‚îú‚îÄ‚îÄ aisha_v2/           # –ê–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–µ–∫—Ç
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ alembic/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ docs/
‚îî‚îÄ‚îÄ setup.py
```

#### ‚úÖ –°—Ç–∞–ª–æ:
```
aisha_bot_new/          # –ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
‚îú‚îÄ‚îÄ app/                # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îî‚îÄ‚îÄ shared/
‚îú‚îÄ‚îÄ tests/              # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ alembic/            # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îú‚îÄ‚îÄ docs/               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ archive/            # Legacy –∫–æ–¥
‚îÇ   ‚îî‚îÄ‚îÄ aisha_v1_legacy/
‚îú‚îÄ‚îÄ scripts/            # –£—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ storage/            # –§–∞–π–ª—ã
‚îú‚îÄ‚îÄ .env                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ alembic.ini
‚îú‚îÄ‚îÄ pytest.ini
‚îú‚îÄ‚îÄ pyproject.toml
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ setup.py
```

### 2. üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã:
- **60 —Ñ–∞–π–ª–æ–≤** –æ–±–Ω–æ–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- `from aisha_v2.app.*` ‚Üí `from app.*`
- `import aisha_v2.app.*` ‚Üí `import app.*`

#### ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
- `setup.py`: `aisha_v2` ‚Üí `aisha_bot` v2.0.0
- `app/core/config.py`: –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- `alembic/env.py`: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω
- `requirements.txt`: –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

#### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã:
- `tests/services/test_audio_service.py`: –∏–º–ø–æ—Ä—Ç –∞—É–¥–∏–æ —Å–µ—Ä–≤–∏—Å–∞
- `tests/test_redis.py`: `aioredis` ‚Üí `redis.asyncio`

### 3. üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç:
```bash
$ python -m alembic current
# –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
```

#### ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î:
```
DATABASE_URL: postgresql+asyncpg://aisha_user:***@192.168.0.4:5432/aisha
```

### 4. üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

#### ‚úÖ –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ:
```bash
$ python -m app.main
2025-05-23 18:54:22,100 - __main__ - INFO - –°—Ç–∞—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2025-05-23 18:54:22,103 - __main__ - INFO - –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞...
2025-05-23 18:54:22,516 - aiogram.dispatcher - INFO - Start polling
2025-05-23 18:54:22,866 - aiogram.dispatcher - INFO - Run polling for bot @KAZAI_Aisha_bot
```

#### ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏:
- –û—à–∏–±–∫–∞ `relation "avatars" does not exist` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
- –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### 5. üìã Developer Checklist

#### ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
- `DEV_CHECKLIST.md` ‚Üí `docs/best_practices.md` (—Ä–∞–∑–¥–µ–ª 14)
- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª —É–¥–∞–ª–µ–Ω
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è BaseService

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### ‚úÖ –£–ø—Ä–æ—â–µ–Ω–∏–µ:
1. **–û–¥–∏–Ω —É—Ä–æ–≤–µ–Ω—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏** –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö
2. **–ü—Ä—è–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã**: `from app.core.config` –≤–º–µ—Å—Ç–æ `from aisha_v2.app.core.config`
3. **–õ–æ–≥–∏—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: –≤—Å–µ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞

### ‚úÖ –£–¥–æ–±—Å—Ç–≤–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
1. **–ë—ã—Å—Ç—Ä–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è** - –Ω–µ –Ω—É–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –≤ –ø–æ–¥–ø–∞–ø–∫–∏
2. **–ü—Ä–æ—Å—Ç—ã–µ –ø—É—Ç–∏** –≤ IDE –∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
3. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** Python –ø—Ä–æ–µ–∫—Ç–∞

### ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
1. **Legacy –∫–æ–¥ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω** –≤ `archive/`
2. **Git –∏—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞**
3. **–û—Ç–∫–∞—Ç –≤–æ–∑–º–æ–∂–µ–Ω** —á–µ—Ä–µ–∑ –≤–µ—Ç–∫—É

## üîÑ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã

### –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞:
```bash
python -m app.main
```

### –ú–∏–≥—Ä–∞—Ü–∏–∏:
```bash
python -m alembic upgrade head
python -m alembic current
```

### –¢–µ—Å—Ç—ã:
```bash
python -m pytest tests/ -v
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
pip install -r requirements.txt
```

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—ã–µ —Ç–µ—Å—Ç—ã
2. **Merge** - –≤–ª–∏—Ç—å –≤–µ—Ç–∫—É –≤ main –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
3. **Deployment** - –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–¥–∞–∫—à–Ω —Å –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
4. **Cleanup** - —É–¥–∞–ª–∏—Ç—å `archive/` —á–µ—Ä–µ–∑ –º–µ—Å—è—Ü

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

- [x] Legacy –∫–æ–¥ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω
- [x] –§–∞–π–ª—ã –ø–µ—Ä–µ–º–µ—â–µ–Ω—ã –≤ –∫–æ—Ä–µ–Ω—å
- [x] –ò–º–ø–æ—Ä—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã (60 —Ñ–∞–π–ª–æ–≤)
- [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- [x] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [x] Developer Checklist –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- [x] –¢–µ—Å—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- [x] Requirements.txt –æ–±–Ω–æ–≤–ª–µ–Ω

---

**üéâ –†–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!**

–ü—Ä–æ–µ–∫—Ç —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç —á–∏—Å—Ç—É—é, –ª–æ–≥–∏—á–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –≥–æ—Ç–æ–≤ –∫ –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. 
# –ü–ª–∞–Ω —É–¥–∞–ª–µ–Ω–∏—è LEGACY –∫–æ–¥–∞

**–î–∞—Ç–∞:** 13.06.2025  
**–°—Ç–∞—Ç—É—Å:** üöÄ –ì–û–¢–û–í –ö –í–´–ü–û–õ–ù–ï–ù–ò–Æ  
**–ü—Ä–µ–¥—ã–¥—É—â–∏–µ —ç—Ç–∞–ø—ã:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–´

## üéØ –¶–µ–ª—å

–£–¥–∞–ª–∏—Ç—å –≤—Å–µ LEGACY —Ñ–∞–π–ª—ã –∏ –∫–æ–¥ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –º–µ–Ω—é –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –æ—à–∏–±–æ–∫.

## ‚úÖ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è (–í–´–ü–û–õ–ù–ï–ù–´)

- [x] –ù–æ–≤–∞—è –º–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ–Ω—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç  
- [x] –í—Å–µ –∫–æ–ª–ª–±–µ–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [x] BaseHandler –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- [x] –ö–æ–º–∞–Ω–¥–∞ `/start` —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] 100% –ø–æ–∫—Ä—ã—Ç–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–æ–ª–ª–±–µ–∫–æ–≤  
- [x] –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- [x] –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã

## üóëÔ∏è –§–∞–π–ª—ã –∫ —É–¥–∞–ª–µ–Ω–∏—é

### 1. –û—Å–Ω–æ–≤–Ω—ã–µ LEGACY —Ñ–∞–π–ª—ã

```bash
# –ì–ª–∞–≤–Ω—ã–π LEGACY —Ñ–∞–π–ª (1258 —Å—Ç—Ä–æ–∫)
app/handlers/main_menu.py

# LEGACY –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–µ—Å–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω–µ–Ω—ã)
app/keyboards/main.py  # (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)

# LEGACY –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
docs/MENU_REFACTORING_PLAN.md
docs/MENU_REFACTORING_RESULTS.md  
docs/MENU_REFACTORING_FINAL.md
```

### 2. LEGACY –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ

–ù–∞–π—Ç–∏ –∏ —É–¥–∞–ª–∏—Ç—å –±–ª–æ–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤:
- `# ==================== LEGACY ...`
- `# TODO: –£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞`
- `# LEGACY: ...`

### 3. LEGACY –∏–º–ø–æ—Ä—Ç—ã

```python
# –í —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
from app.handlers.main_menu import ...  # –£–¥–∞–ª–∏—Ç—å
from app.keyboards.main import get_ai_creativity_menu  # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
```

## üîç –ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω

### –≠—Ç–∞–ø 1: –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (15 –º–∏–Ω—É—Ç)

1. **–ü–æ–∏—Å–∫ –≤—Å–µ—Ö –∏–º–ø–æ—Ä—Ç–æ–≤ main_menu:**
   ```bash
   grep -r "from app.handlers.main_menu" . --include="*.py"
   grep -r "import.*main_menu" . --include="*.py"
   ```

2. **–ü–æ–∏—Å–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è LEGACY —Ñ—É–Ω–∫—Ü–∏–π:**
   ```bash
   grep -r "get_ai_creativity_menu\|get_images_menu\|get_my_projects_menu" . --include="*.py"
   ```

3. **–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π keyboards/main.py:**
   ```bash
   grep -r "from app.keyboards.main import" . --include="*.py"
   ```

### –≠—Ç–∞–ø 2: –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (10 –º–∏–Ω—É—Ç)

1. **–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤ .LEGACY:**
   ```bash
   mv app/handlers/main_menu.py app/handlers/main_menu.py.LEGACY
   ```

2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π

3. **–û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ —É—Å–ø–µ—Ö–µ:**
   ```bash
   rm app/handlers/main_menu.py.LEGACY
   ```

### –≠—Ç–∞–ø 3: –û—á–∏—Å—Ç–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ (10 –º–∏–Ω—É—Ç)

1. **–ü–æ–∏—Å–∫ LEGACY –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤:**
   ```bash
   grep -r "LEGACY\|TODO.*—É–¥–∞–ª–∏—Ç—å" . --include="*.py"
   ```

2. **–£–¥–∞–ª–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –≤ –∫–∞–∂–¥–æ–º —Ñ–∞–π–ª–µ**

### –≠—Ç–∞–ø 4: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (5 –º–∏–Ω—É—Ç)

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—Å–∫–∞:** `python -m app.main`
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:** `/start`, –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –º–µ–Ω—é
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤:** –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫ import

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã:
- **–£–¥–∞–ª–µ–Ω–∏–µ:** ~1500+ —Å—Ç—Ä–æ–∫ LEGACY –∫–æ–¥–∞
- **–£–ø—Ä–æ—â–µ–Ω–∏–µ:** –°—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–º–ø–æ—Ä—Ç–æ–≤
- **–£–ª—É—á—à–µ–Ω–∏–µ:** –ß–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- –£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª–µ–π
- –°–Ω–∏–∂–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏
- –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å:
- –ï–¥–∏–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–µ–∑ LEGACY –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è  
- –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ –º–æ–¥—É–ª—è–º
- –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∫–æ–¥—É

## ‚ö†Ô∏è –ú–µ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏

1. **–ë—ç–∫–∞–ø –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º:**
   ```bash
   git tag before-legacy-cleanup
   ```

2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∏–∑–æ–ª—è—Ü–∏–∏:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞

3. **–û—Ç–∫–∞—Ç –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:**
   ```bash
   git reset --hard before-legacy-cleanup
   ```

## üö¶ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [x] ‚úÖ –í—Å–µ –∫–æ–ª–ª–±–µ–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- [x] ‚úÖ BaseHandler –∏—Å–ø—Ä–∞–≤–ª–µ–Ω  
- [x] ‚úÖ –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞
- [x] ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã
- [ ] üéØ **READY TO START CLEANUP**

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ —É–¥–∞–ª–µ–Ω–∏—è LEGACY –∫–æ–¥–∞ 
# üîÑ –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û –ò –†–ê–ó–í–ï–†–ù–£–¢–û**  
**–î–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 11.06.2025  
**–¢–µ–≥ –¥–µ–ø–ª–æ—è:** `avatar-rename-feature`

## üìù –û–ø–∏—Å–∞–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä—è–º–æ –∏–∑ –≥–∞–ª–µ—Ä–µ–∏ –∞–≤–∞—Ç–∞—Ä–æ–≤. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è —Å–≤–æ–∏—Ö –∞–≤–∞—Ç–∞—Ä–æ–≤, –ø–æ—Å–ª–µ —á–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Ä–∞–∂–∞—é—Ç—Å—è –≤ –≥–∞–ª–µ—Ä–µ–µ.

## üéØ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### üîç –ì–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å"
- ‚úÖ **–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∞–≤–∞—Ç–∞—Ä—ã** (—Å—Ç–∞—Ç—É—Å `COMPLETED`)
- ‚úÖ **–ê–≤–∞—Ç–∞—Ä—ã –≤ –æ–±—É—á–µ–Ω–∏–∏** (—Å—Ç–∞—Ç—É—Å `TRAINING`)  
- ‚úÖ **–ì–æ—Ç–æ–≤—ã–µ –∫ –æ–±—É—á–µ–Ω–∏—é** (—Å—Ç–∞—Ç—É—Å `READY_FOR_TRAINING`)
- ‚ùå **–ß–µ—Ä–Ω–æ–≤–∏–∫–∏** (—Å—Ç–∞—Ç—É—Å `DRAFT`)
- ‚ùå **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ** (—Å—Ç–∞—Ç—É—Å `PHOTOS_UPLOADING`)

### üéõÔ∏è –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
1. **–ö–Ω–æ–ø–∫–∞ "‚úèÔ∏è –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å"** - –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –∞–≤–∞—Ç–∞—Ä–∞
2. **–§–æ—Ä–º–∞ –≤–≤–æ–¥–∞** - —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ –Ω–æ–≤–æ–≥–æ –∏–º–µ–Ω–∏
3. **–ö–Ω–æ–ø–∫–∞ "‚ùå –û—Ç–º–µ–Ω–∞"** - –¥–ª—è –æ—Ç–º–µ–Ω—ã –ø—Ä–æ—Ü–µ—Å—Å–∞

### üìã –ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "‚úèÔ∏è –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å"
2. –ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ –∏–º—è –∏ –ø—Ä–æ—Å–∏—Ç –≤–≤–µ—Å—Ç–∏ –Ω–æ–≤–æ–µ
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –Ω–æ–≤–æ–µ –∏–º—è (2-30 —Å–∏–º–≤–æ–ª–æ–≤)
4. –ò–º—è –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
5. –ì–∞–ª–µ—Ä–µ—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### üìÅ –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã

#### üÜï –ù–æ–≤—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è FSM
```python
# app/handlers/state.py
class AvatarStates(StatesGroup):
    renaming_avatar = State()  # –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞
```

#### üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
```python
# app/handlers/avatar/gallery/keyboards.py
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "‚úèÔ∏è –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å" (callback: avatar_rename:{avatar_id})
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –æ—Ç–º–µ–Ω—ã (get_rename_cancel_keyboard)
```

#### üöÄ –ù–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
```python
# app/handlers/avatar/gallery/avatar_actions.py
- handle_rename_avatar() - –Ω–∞—á–∞–ª–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
- handle_rename_avatar_cancel() - –æ—Ç–º–µ–Ω–∞ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
- process_avatar_rename() - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –Ω–æ–≤–æ–≥–æ –∏–º–µ–Ω–∏
```

#### üîó –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–æ—É—Ç–æ–≤
```python
# app/handlers/avatar/gallery/main_handler.py
- avatar_rename:{avatar_id} -> handle_rename_avatar
- avatar_rename_cancel:{avatar_id} -> handle_rename_avatar_cancel
- message –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ renaming_avatar -> handle_rename_text_input
```

### üóÑÔ∏è –°–µ—Ä–≤–∏—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ `AvatarService.set_avatar_name()`:
```python
async def set_avatar_name(self, avatar_id: UUID, name: str) -> Optional[Avatar]:
    """–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–º—è –∞–≤–∞—Ç–∞—Ä–∞"""
```

### ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω–∏
- **–ú–∏–Ω–∏–º—É–º:** 2 —Å–∏–º–≤–æ–ª–∞
- **–ú–∞–∫—Å–∏–º—É–º:** 30 —Å–∏–º–≤–æ–ª–æ–≤  
- **–ù–µ –ø—É—Å—Ç–æ–µ:** –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ
- **–ê–≤—Ç–æ—Ç—Ä–∏–º–º–∏–Ω–≥:** —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–±–µ–ª–æ–≤ –ø–æ –∫—Ä–∞—è–º

## üé® UX/UI —É–ª—É—á—à–µ–Ω–∏—è

### üì± –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞
- –ö–Ω–æ–ø–∫–∏ —Ä–∞–∑–º–µ—â–µ–Ω—ã –≤ –ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ
- "–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å" —Ä—è–¥–æ–º —Å "–û—Å–Ω–æ–≤–Ω–æ–π" 
- "–£–¥–∞–ª–∏—Ç—å" –≤—ã–Ω–µ—Å–µ–Ω–æ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—Ç—Ä–æ–∫—É

### üí¨ –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
```
‚úèÔ∏è –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞

üè∑Ô∏è –¢–µ–∫—É—â–µ–µ –∏–º—è: –°—Ç–∞—Ä–æ–µ –∏–º—è

üìù –í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –∏–º—è –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞:

üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
‚Ä¢ –î–ª–∏–Ω–∞: 2-30 —Å–∏–º–≤–æ–ª–æ–≤
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–Ω—è—Ç–Ω—ã–µ –∏–º–µ–Ω–∞
‚Ä¢ –ò–∑–±–µ–≥–∞–π—Ç–µ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤

‚úÖ –ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–æ–≤–æ–µ –∏–º—è –≤ —á–∞—Ç
```

### üîÑ –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
- ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
- ‚ùå –ü–æ–Ω—è—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–∞–ª–µ—Ä–µ–∏

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### ‚úÖ –ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
1. **–ù–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–∫–∏** –≤ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∞–≤–∞—Ç–∞—Ä–∞—Ö ‚úÖ
2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–Ω–æ–ø–∫–∏** –≤ —á–µ—Ä–Ω–æ–≤–∏–∫–∞—Ö ‚úÖ 
3. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤** –≤ —Ä–æ—É—Ç–µ—Ä–µ ‚úÖ
4. **–í–∞–ª–∏–¥–∞—Ü–∏—è callback_data** ‚úÖ
5. **–î–µ–ø–ª–æ–π –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω** –±–µ–∑ –æ—à–∏–±–æ–∫ ‚úÖ

### üîß –ì–æ—Ç–æ–≤—ã–π —Ç–µ—Å—Ç-—Å–∫—Ä–∏–ø—Ç
```bash
python3 scripts/testing/test_rename_feature.py
```

## üìä –õ–æ–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### ‚ú® –î–æ–±–∞–≤–ª–µ–Ω–æ
- –ö–Ω–æ–ø–∫–∞ "‚úèÔ∏è –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å" –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –∞–≤–∞—Ç–∞—Ä–∞
- FSM —Å–æ—Å—Ç–æ—è–Ω–∏–µ `AvatarStates.renaming_avatar`
- 3 –Ω–æ–≤—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤ `AvatarActionsHandler`
- –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –æ—Ç–º–µ–Ω—ã –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω–∏ –∞–≤–∞—Ç–∞—Ä–∞ (2-30 —Å–∏–º–≤–æ–ª–æ–≤)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –≥–∞–ª–µ—Ä–µ–∏

### üîÑ –ò–∑–º–µ–Ω–µ–Ω–æ
- –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞ (—Ä–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫)
- –†–æ—É—Ç–µ—Ä –≥–∞–ª–µ—Ä–µ–∏ –∞–≤–∞—Ç–∞—Ä–æ–≤ (–Ω–æ–≤—ã–µ callback handlers)

### üö´ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –ö–Ω–æ–ø–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤ –∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ
- –¢–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∏–º–µ–Ω–∞ (–±–µ–∑ —ç–º–æ–¥–∑–∏ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏)

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### üì¶ –î–µ–ø–ª–æ–π
```bash
scripts/deployment/deploy-via-registry.sh avatar-rename-feature
```

### üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```bash
scripts/monitoring/quick-logs.sh bot
```

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
1. –û—Ç–∫—Ä—ã—Ç—å –≥–∞–ª–µ—Ä–µ—é –∞–≤–∞—Ç–∞—Ä–æ–≤ –≤ –±–æ—Ç–µ
2. –ù–∞–π—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π –∞–≤–∞—Ç–∞—Ä
3. –£–±–µ–¥–∏—Ç—å—Å—è –≤ –Ω–∞–ª–∏—á–∏–∏ –∫–Ω–æ–ø–∫–∏ "‚úèÔ∏è –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å"
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### üí° –í–æ–∑–º–æ–∂–Ω—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —ç–º–æ–¥–∑–∏ –≤ –∏–º–µ–Ω–∞—Ö –∞–≤–∞—Ç–∞—Ä–æ–≤
- [ ] –ú–∞—Å—Å–æ–≤–æ–µ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
- [ ] –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–º–µ–Ω
- [ ] –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏–º–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –ò–ò
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –∏–º–µ–Ω —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### üéØ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- [ ] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –∏—Å—Ç–æ—Ä–∏–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–π
- [ ] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ
- [ ] –£–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö

---

**üë®‚Äçüíª –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** AI Assistant  
**üìÖ –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 11.06.2025  
**üîÑ –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 11.06.2025 
# üé≠ –ü–æ—Ä—Ç—Ä–µ—Ç–Ω—ã–µ –∞–≤–∞—Ç–∞—Ä—ã - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

> **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ  
> **–î–∞—Ç–∞**: 23 –º–∞—è 2025  
> **–í–µ—Ä—Å–∏—è**: 1.0

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –ø–æ—Ä—Ç—Ä–µ—Ç–Ω—ã—Ö –∞–≤–∞—Ç–∞—Ä–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ—Ä—Ç—Ä–µ—Ç—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ **FAL AI flux-lora-portrait-trainer**.

### üéØ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –ª–∏—Ü–∞—Ö**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–π —Å—ä–µ–º–∫–∏
- **–ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ**: 3-15 –º–∏–Ω—É—Ç (–≤ 2-3 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ)
- **–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ª–∏—Ü
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –û–±—Ä–µ–∑–∫–∞ —Å—É–±—ä–µ–∫—Ç–æ–≤ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –º–∞—Å–æ–∫
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**: –ú–∏–Ω–∏–º—É–º –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

```
üé≠ Portrait Avatar System
‚îú‚îÄ‚îÄ üì± User Interface
‚îÇ   ‚îú‚îÄ‚îÄ app/handlers/avatar/portrait_handler.py
‚îÇ   ‚îú‚îÄ‚îÄ app/texts/avatar.py (TRAINING_TYPE_TEXTS)
‚îÇ   ‚îî‚îÄ‚îÄ app/keyboards/avatar_clean.py
‚îú‚îÄ‚îÄ ü§ñ Training Services
‚îÇ   ‚îú‚îÄ‚îÄ app/services/fal/client.py (FalAIClient)
‚îÇ   ‚îú‚îÄ‚îÄ app/services/avatar/fal_training_service/ (FALTrainingService)
‚îÇ   ‚îî‚îÄ‚îÄ app/services/avatar/training_service/ (Legacy support)
‚îú‚îÄ‚îÄ üóÑÔ∏è Database Models
‚îÇ   ‚îú‚îÄ‚îÄ Avatar.training_type = "portrait"
‚îÇ   ‚îú‚îÄ‚îÄ Avatar.trigger_phrase
‚îÇ   ‚îú‚îÄ‚îÄ Avatar.steps, learning_rate
‚îÇ   ‚îî‚îÄ‚îÄ Portrait-specific settings
‚îî‚îÄ‚îÄ ‚öôÔ∏è Configuration
    ‚îú‚îÄ‚îÄ app/core/config.py (FAL_PORTRAIT_*)
    ‚îî‚îÄ‚îÄ env_template.txt
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FAL AI

```python
# Endpoint –¥–ª—è –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
ENDPOINT = "fal-ai/flux-lora-portrait-trainer"

# –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
{
    "images_data_url": "https://fal.ai/archive.zip",
    "trigger_phrase": "PERSON_12345678",
    "steps": 1000,
    "learning_rate": 0.0002,
    "multiresolution_training": True,
    "subject_crop": True,
    "create_masks": False
}
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–≥–æ –∞–≤–∞—Ç–∞—Ä–∞

```python
from app.services.fal.client import FalAIClient

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
fal_client = FalAIClient()

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
portrait_config = {
    "training_type": "portrait",
    "trigger_phrase": "PERSON_12345678",
    "steps": 1000,
    "learning_rate": 0.0002,
    "multiresolution_training": True,
    "subject_crop": True,
    "create_masks": False,
    "webhook_url": "https://your-webhook.com/status"
}

# –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è
request_id = await fal_client.train_avatar(
    user_id=user_id,
    avatar_id=avatar_id,
    name="–ú–æ–π –ø–æ—Ä—Ç—Ä–µ—Ç",
    gender="male",
    photo_urls=photo_urls,
    training_config=portrait_config
)
```

### 2. –ß–µ—Ä–µ–∑ FAL Training Service

```python
from app.services.avatar.fal_training_service import FALTrainingService

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞
fal_service = FALTrainingService()

# –ó–∞–ø—É—Å–∫ –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
request_id = await fal_service.start_avatar_training(
    avatar_id=avatar_id,
    training_type="portrait",
    training_data_url=training_data_url,
    user_preferences={"quality": "balanced"}
)

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–∏–ø–µ –æ–±—É—á–µ–Ω–∏—è
type_info = fal_service.get_training_type_info("portrait")
```

### 3. –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞

```python
# –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞
request_id = await fal_client.train_portrait_model(
    images_data_url=images_data_url,
    trigger_phrase="PERSON_12345678",
    steps=1000,
    learning_rate=0.0002,
    multiresolution_training=True,
    subject_crop=True,
    create_masks=False,
    webhook_url=webhook_url
)
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
FAL_PORTRAIT_STEPS=1000
FAL_PORTRAIT_LEARNING_RATE=0.0002
FAL_PORTRAIT_SUBJECT_CROP=true
FAL_PORTRAIT_CREATE_MASKS=false
FAL_PORTRAIT_MULTIRESOLUTION=true

# –ü—Ä–µ—Å–µ—Ç—ã –∫–∞—á–µ—Å—Ç–≤–∞ –¥–ª—è –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤
FAL_FAST_PORTRAIT_STEPS=300
FAL_FAST_PORTRAIT_LR=0.0003

FAL_BALANCED_PORTRAIT_STEPS=600
FAL_BALANCED_PORTRAIT_LR=0.0002

FAL_QUALITY_PORTRAIT_STEPS=1000
FAL_QUALITY_PORTRAIT_LR=0.0001

# Webhook –¥–ª—è –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
FAL_WEBHOOK_PORTRAIT_URL=https://your-domain.com/api/avatar/status_update?training_type=portrait
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ config.py

```python
class Settings(BaseSettings):
    # –ü–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
    FAL_PORTRAIT_STEPS: int = Field(1000, env="FAL_PORTRAIT_STEPS")
    FAL_PORTRAIT_LEARNING_RATE: float = Field(0.0002, env="FAL_PORTRAIT_LEARNING_RATE")
    FAL_PORTRAIT_SUBJECT_CROP: bool = Field(True, env="FAL_PORTRAIT_SUBJECT_CROP")
    FAL_PORTRAIT_CREATE_MASKS: bool = Field(False, env="FAL_PORTRAIT_CREATE_MASKS")
    FAL_PORTRAIT_MULTIRESOLUTION: bool = Field(True, env="FAL_PORTRAIT_MULTIRESOLUTION")
    
    @property
    def FAL_PRESET_FAST(self) -> Dict[str, Any]:
        return {
            "portrait": {
                "steps": self.FAL_FAST_PORTRAIT_STEPS, 
                "learning_rate": self.FAL_FAST_PORTRAIT_LR
            },
            "general": {
                "iterations": 200, 
                "learning_rate": 0.0003
            }
        }
```

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –æ–±—É—á–µ–Ω–∏—è

| –ö—Ä–∏—Ç–µ—Ä–∏–π | üé≠ –ü–æ—Ä—Ç—Ä–µ—Ç–Ω—ã–π | üé® –•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π |
|----------|---------------|-------------------|
| **API Endpoint** | flux-lora-portrait-trainer | flux-pro-trainer |
| **–õ—É—á—à–µ –¥–ª—è** | –õ–∏—Ü–∞ –ª—é–¥–µ–π | –°—Ç–∏–ª–∏, –æ–±—ä–µ–∫—Ç—ã |
| **–°–∫–æ—Ä–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê‚≠ê (3-15 –º–∏–Ω) | ‚≠ê‚≠ê‚≠ê (5-30 –º–∏–Ω) |
| **–ö–∞—á–µ—Å—Ç–≤–æ –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê |
| **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| **–ü—Ä–æ—Å—Ç–æ—Ç–∞** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê |
| **–ü–∞—Ä–∞–º–µ—Ç—Ä –æ–±—É—á–µ–Ω–∏—è** | steps | iterations |
| **–¢—Ä–∏–≥–≥–µ—Ä** | trigger_phrase | trigger_word |
| **–ê–≤—Ç–æ–æ–±—Ä–µ–∑–∫–∞** | ‚úÖ subject_crop | ‚ùå |
| **–ú–∞—Å–∫–∏** | ‚úÖ create_masks | ‚ùå |

## üîÑ Workflow –æ–±—É—á–µ–Ω–∏—è

### 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

```
üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç "–°–æ–∑–¥–∞—Ç—å –∞–≤–∞—Ç–∞—Ä"
    ‚Üì
üéØ –í—ã–±–æ—Ä —Ç–∏–ø–∞: "–ü–æ—Ä—Ç—Ä–µ—Ç–Ω—ã–π" –∏–ª–∏ "–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π"
    ‚Üì
üë®/üë© –í—ã–±–æ—Ä –ø–æ–ª–∞ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
    ‚Üì
üìù –í–≤–æ–¥ –∏–º–µ–Ω–∏ –∞–≤–∞—Ç–∞—Ä–∞
    ‚Üì
üì∏ –ó–∞–≥—Ä—É–∑–∫–∞ 10-20 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
    ‚Üì
üöÄ –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è
```

### 2. –°–µ—Ä–≤–µ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

```
üì¶ –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏
    ‚Üì
üé≠ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –æ–±—É—á–µ–Ω–∏—è (portrait/style)
    ‚Üì
‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–≥–æ —Ç—Ä–µ–Ω–µ—Ä–∞
    ‚Üì
üåê –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –≤ FAL AI flux-lora-portrait-trainer
    ‚Üì
üìã –ü–æ–ª—É—á–µ–Ω–∏–µ request_id
    ‚Üì
üîç –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å—Ç–∞—Ç—É—Å–∞
    ‚Üì
üì¨ –û–±—Ä–∞–±–æ—Ç–∫–∞ webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    ‚Üì
‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è
```

### 3. –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—É—á–µ–Ω–∏—è

```python
# –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
{
    "diffusers_lora_file": {
        "url": "https://fal.ai/files/lora_weights.safetensors",
        "content_type": "application/octet-stream",
        "file_name": "portrait_lora.safetensors",
        "file_size": 144000000
    },
    "config_file": {
        "url": "https://fal.ai/files/training_config.json",
        "content_type": "application/json",
        "file_name": "config.json",
        "file_size": 2048
    }
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –¢–µ—Å—Ç –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
python test_portrait_avatars.py

# –†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞
üé≠ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–æ–≤
==================================================
‚úÖ –ü–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!
üìã Request ID: test_5f8a8728_c20b8cf4
üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏:
   name: –ü–æ—Ä—Ç—Ä–µ—Ç–Ω—ã–π
   description: –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –ª—é–¥–µ–π
   speed: ‚≠ê‚≠ê‚≠ê‚≠ê (3-15 –º–∏–Ω—É—Ç)
   quality_portraits: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
   best_for: ['–°–µ–ª—Ñ–∏', '–ü–æ—Ä—Ç—Ä–µ—Ç—ã', '–§–æ—Ç–æ –ª—é–¥–µ–π']
   technology: Flux LoRA Portrait Trainer
```

### –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º

–í —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ (`AVATAR_TEST_MODE=true`):
- –ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤ FAL AI
- –ò–º–∏—Ç–∏—Ä—É–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è
- –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –º–æ–∫ request_id
- –°–∏–º—É–ª–∏—Ä—É–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

```python
# 1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ API –∫–ª—é—á–∞
try:
    request_id = await fal_client.train_portrait_model(...)
except MissingCredentialsError:
    logger.warning("FAL API –∫–ª—é—á –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤ —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º")
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤ —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º

# 2. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
if len(photo_urls) < 10:
    raise ValueError("–î–ª—è –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 10 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π")

# 3. –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∞—Ä—Ö–∏–≤–∞
if not training_data_url:
    raise RuntimeError("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∞—Ä—Ö–∏–≤ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏")

# 4. –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –æ–±—É—á–µ–Ω–∏—è
if not request_id:
    raise RuntimeError("FAL AI –Ω–µ —Å–º–æ–≥ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ")
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞

```python
# –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
if avatar.training_type == AvatarTrainingType.PORTRAIT:
    # flux-lora-portrait-trainer –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∞–π–ª—ã LoRA
    diffusers_file = result.get("diffusers_lora_file", {})
    config_file = result.get("config_file", {})
    
    update_data.update({
        "diffusers_lora_file_url": diffusers_file.get("url"),
        "config_file_url": config_file.get("url")
    })
```

### –°—Ç–∞—Ç—É—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
if training_type == "portrait":
    endpoint = "fal-ai/flux-lora-portrait-trainer"
else:
    endpoint = "fal-ai/flux-pro-trainer"

status = await fal_client.status_async(endpoint, request_id, with_logs=True)
```

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ—Ç–æ**: 10-20 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
2. **–ö–∞—á–µ—Å—Ç–≤–æ**: –í—ã—Å–æ–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ (–º–∏–Ω–∏–º—É–º 512√ó512)
3. **–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ**: –†–∞–∑–Ω—ã–µ —Ä–∞–∫—É—Ä—Å—ã –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –ª–∏—Ü–∞
4. **–û—Å–≤–µ—â–µ–Ω–∏–µ**: –•–æ—Ä–æ—à–µ–µ, —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ
5. **–§–æ–Ω**: –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —Ñ–æ–Ω—ã
6. **–û–¥–∏–Ω —á–µ–ª–æ–≤–µ–∫**: –ù–∞ –∫–∞–∂–¥–æ–º —Ñ–æ—Ç–æ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —á–µ–ª–æ–≤–µ–∫

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

1. **–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –±–µ–∑ –∑–∞—Ç—Ä–∞—Ç
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –ü—Ä–µ–¥—É—Å–º–æ—Ç—Ä–∏—Ç–µ fallback –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
5. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ò–∑–±–µ–≥–∞–π—Ç–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [FAL AI Portrait Trainer API](../fal_knowlege_base/flux-lora-portrait-trainer-api.md)
- [–°—Ä–∞–≤–Ω–µ–Ω–∏–µ FAL AI –º–æ–¥–µ–ª–µ–π](../fal_knowlege_base/fal-ai-models-comparison.md)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ FAL AI](../guides/fal_ai_integration.md)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã –∞–≤–∞—Ç–∞—Ä–æ–≤](../AVATAR_ARCHITECTURE_CONSOLIDATED.md)

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 23 –º–∞—è 2025  
**–ê–≤—Ç–æ—Ä**: AI Assistant 
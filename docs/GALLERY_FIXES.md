# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≥–∞–ª–µ—Ä–µ–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

–ò–∑ –ª–æ–≥–æ–≤ –±–æ—Ç–∞ –±—ã–ª–∏ –≤–∏–¥–Ω—ã –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ callback'–∏ –≥–∞–ª–µ—Ä–µ–∏:

```
2025-06-10 17:29:06,654 - app.handlers.fallback - WARNING - –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback: gallery_image_next:0 –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 174171680
2025-06-10 17:29:16,147 - app.handlers.fallback - WARNING - –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback: gallery_filters –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 174171680
2025-06-10 17:29:19,077 - app.handlers.fallback - WARNING - –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback: gallery_stats –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 174171680
2025-06-10 17:29:20,847 - app.handlers.fallback - WARNING - –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback: gallery_full_prompt:8b60d6f3-1505-4bd6-9ad0-eb3a22c9d37a –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 174171680
2025-06-10 17:29:22,582 - app.handlers.fallback - WARNING - –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback: gallery_regenerate:8b60d6f3-1505-4bd6-9ad0-eb3a22c9d37a –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 174171680
2025-06-10 17:29:24,401 - app.handlers.fallback - WARNING - –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback: gallery_favorite:8b60d6f3-1505-4bd6-9ad0-eb3a22c9d37a –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 174171680
2025-06-10 17:29:25,967 - app.handlers.fallback - WARNING - –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π callback: gallery_delete:8b60d6f3-1505-4bd6-9ad0-eb3a22c9d37a –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 174171680
```

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–ê–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ:

1. **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±—ã–ª–∏ –Ω–∞–ø–∏—Å–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ** –≤ `app/handlers/gallery/main_handler.py`:
   - `@router.callback_query(F.data.startswith("gallery_image_next:"))`
   - `@router.callback_query(F.data.startswith("gallery_filters"))`
   - `@router.callback_query(F.data.startswith("gallery_stats"))`
   - –∏ –¥—Ä—É–≥–∏–µ...

2. **–†–æ—É—Ç–µ—Ä—ã –≥–∞–ª–µ—Ä–µ–∏ –Ω–µ –±—ã–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã** –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

–í —Ñ–∞–π–ª–µ `app/main.py` –±—ã–ª–∏ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã —Å—Ç—Ä–æ–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–æ—É—Ç–µ—Ä–æ–≤:

```python
# –ë—ã–ª–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ:
# dp.include_router(gallery_main_router)
# dp.include_router(gallery_filter_router)

# –°—Ç–∞–ª–æ –∞–∫—Ç–∏–≤–Ω—ã–º:
dp.include_router(gallery_main_router)
dp.include_router(gallery_filter_router)
```

## üìã –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ callback'–∏

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ callback'–∏ –≥–∞–ª–µ—Ä–µ–∏:

### –ù–∞–≤–∏–≥–∞—Ü–∏—è
- `gallery_image_next:{index}` - –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é
- `gallery_image_prev:{index}` - –ø–µ—Ä–µ—Ö–æ–¥ –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
- `gallery_full_prompt:{generation_id}` - –ø–æ–∫–∞–∑ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞
- `gallery_favorite:{generation_id}` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
- `gallery_regenerate:{generation_id}` - –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
- `gallery_delete:{generation_id}` - —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `gallery_delete_confirm:{generation_id}` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è

### –§–∏–ª—å—Ç—Ä—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `gallery_filters` - –º–µ–Ω—é —Ñ–∏–ª—å—Ç—Ä–æ–≤
- `gallery_stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≥–∞–ª–µ—Ä–µ–∏
- `gallery_filter_date` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–µ
- `gallery_filter_avatar` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∞–≤–∞—Ç–∞—Ä—É
- `gallery_filter_prompt` - –ø–æ–∏—Å–∫ –ø–æ –ø—Ä–æ–º–ø—Ç—É
- `gallery_filter_favorites` - —Ç–æ–ª—å–∫–æ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ
- `my_gallery` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≥–∞–ª–µ—Ä–µ–∏
- `my_gallery_return:{generation_id}` - –≤–æ–∑–≤—Ä–∞—Ç –∫ –≥–∞–ª–µ—Ä–µ–µ —Å –ø–æ–∑–∏—Ü–∏–µ–π
- `noop` - –ø—É—Å—Ç—ã–µ callback'–∏

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –≥–∞–ª–µ—Ä–µ—é: `/start` ‚Üí `üñºÔ∏è –ú–æ—è –≥–∞–ª–µ—Ä–µ—è`
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–≤–∏–≥–∞—Ü–∏—é: ‚¨ÖÔ∏è / ‚û°Ô∏è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–Ω–æ–ø–∫–∏: `üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞`, `üîç –§–∏–ª—å—Ç—Ä—ã`
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è: `üìã –ü—Ä–æ–º–ø—Ç`, `ü§ç –í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ`, `üóëÔ∏è –£–¥–∞–ª–∏—Ç—å`

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `app/main.py` - —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã —Ä–æ—É—Ç–µ—Ä—ã –≥–∞–ª–µ—Ä–µ–∏
- `docs/GALLERY_FIXES.md` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

## üöÄ –°—Ç–∞—Ç—É—Å

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ** - –≤—Å–µ callback'–∏ –≥–∞–ª–µ—Ä–µ–∏ —Ç–µ–ø–µ—Ä—å –¥–æ–ª–∂–Ω—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ 
# –û—Ç—á—ë—Ç –æ Legacy —Ñ—É–Ω–∫—Ü–∏—è—Ö –∏ –¥—É–±–ª–∏—Ä—É—é—â–µ–º—Å—è –∫–æ–¥–µ

## üéØ –¶–µ–ª—å
–ù–∞–π—Ç–∏ –∏ –ø–æ–º–µ—Ç–∏—Ç—å –≤—Å–µ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ Legacy —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è.

## üìã –ù–∞–π–¥–µ–Ω–Ω—ã–µ Legacy —Ñ—É–Ω–∫—Ü–∏–∏

### 1. **Avatar Service** 

#### üî¥ `app/services/avatar_db.py`
- **–°—Ç—Ä–æ–∫–∞ 193:** `delete_avatar()` - LEGACY –∞–ª–∏–∞—Å –¥–ª—è `delete_avatar_completely`
  ```python
  # LEGACY: –£—Å—Ç–∞—Ä–µ–≤—à–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
  # TODO: –£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö –≤—ã–∑–æ–≤–æ–≤ –Ω–∞ delete_avatar_completely
  async def delete_avatar(self, avatar_id: UUID) -> bool:
  ```
  - **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–û–ú–ï–ß–ï–ù–û –∫–∞–∫ LEGACY
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ –≤—ã–∑–æ–≤—ã –Ω–∞ `delete_avatar_completely`

### 2. **Avatar Handlers**

#### üî¥ `app/handlers/avatar/__init__.py`
- **–°—Ç—Ä–æ–∫–∞ 23:** `AvatarHandler` –∫–ª–∞—Å—Å - LEGACY –∑–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
  ```python
  # =================== LEGACY CODE - –ü–û–ú–ï–¢–ò–¢–¨ –ö –£–î–ê–õ–ï–ù–ò–Æ ===================
  # LEGACY: –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Ç–µ—Å—Ç–∞–º–∏ (–¥–ª—è —Å—Ç–∞—Ä–æ–≥–æ AvatarHandler)
  class AvatarHandler:
  ```
  - **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–û–ú–ï–ß–ï–ù–û –∫–∞–∫ LEGACY
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å —Ç–µ—Å—Ç—ã –Ω–∞ –Ω–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Ä–æ—É—Ç–µ—Ä–æ–≤

- **–°—Ç—Ä–æ–∫–∞ 39:** `process_avatar_name()` - LEGACY –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–º–µ–Ω–∏
  ```python
  # LEGACY: –£—Å—Ç–∞—Ä–µ–≤—à–∏–π –º–µ—Ç–æ–¥ - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ create.py –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ
  async def process_avatar_name(self, message, state):
  ```
  - **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–û–ú–ï–ß–ï–ù–û –∫–∞–∫ LEGACY
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–∑ `create.py`

- **–°—Ç—Ä–æ–∫–∞ 57:** `register_avatar_handlers()` - LEGACY —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
  ```python
  # LEGACY: –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å main.py)
  async def register_avatar_handlers():
  ```
  - **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–û–ú–ï–ß–ï–ù–û –∫–∞–∫ LEGACY
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Ä–æ—É—Ç–µ—Ä—ã

### 3. **Database Models**

#### üî¥ `app/database/models.py`
- **–°—Ç—Ä–æ–∫–∞ 198:** Legacy –ø–æ–ª—è –≤ `Avatar` –º–æ–¥–µ–ª–∏
  ```python
  # =================== LEGACY FIELDS - –ü–û–ú–ï–¢–ò–¢–¨ –ö –£–î–ê–õ–ï–ù–ò–Æ ===================
  # LEGACY: –ü–æ–ª—è –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å–æ —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º–æ–π
  is_draft: Mapped[bool] = mapped_column(Boolean, default=True)  # LEGACY: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ status –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ
  photo_key: Mapped[Optional[str]] = mapped_column(String(255), nullable=True)  # LEGACY: –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
  preview_key: Mapped[Optional[str]] = mapped_column(String(255), nullable=True)  # LEGACY: –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
  ```
  - **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–û–ú–ï–ß–ï–ù–û –∫–∞–∫ LEGACY
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

- **–°—Ç—Ä–æ–∫–∞ 242:** Legacy –ø–æ–ª–µ –≤ `AvatarPhoto` –º–æ–¥–µ–ª–∏
  ```python
  # LEGACY: –ü–æ–ª–µ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
  order: Mapped[int] = mapped_column(Integer, default=0)  # LEGACY: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ upload_order –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ
  ```
  - **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–û–ú–ï–ß–ï–ù–û –∫–∞–∫ LEGACY
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `upload_order`

### 4. **Transcript Services**

#### üî¥ `app/services/transcript.py`
- **–°—Ç—Ä–æ–∫–∞ 157:** `get_user_transcripts()` - LEGACY –º–µ—Ç–æ–¥
  ```python
  # LEGACY: –£—Å—Ç–∞—Ä–µ–≤—à–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
  # TODO: –£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ list_transcripts
  async def get_user_transcripts(self, user_id: Union[int, str, UUID]) -> List[Dict]:
  ```
  - **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–û–ú–ï–ß–ï–ù–û –∫–∞–∫ LEGACY
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `list_transcripts`

#### üî¥ `app/database/repositories/transcript.py`
- **–°—Ç—Ä–æ–∫–∞ 26:** `get_user_transcripts()` - LEGACY —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
  ```python
  # LEGACY: –£—Å—Ç–∞—Ä–µ–≤—à–∏–π –º–µ—Ç–æ–¥ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
  # TODO: –£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–æ–≤
  async def get_user_transcripts(self, user_id: Union[int, str, UUID], limit: int = 10, offset: int = 0) -> List[UserTranscript]:
  ```
  - **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–û–ú–ï–ß–ï–ù–û –∫–∞–∫ LEGACY
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å –Ω–∞ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É

### 5. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è**

#### ‚úÖ `app/keyboards/avatar_clean.py`
- **–°—Ç—Ä–æ–∫–∞ 47:** `get_training_type_keyboard()` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –∏–∑-–∑–∞ Legacy –æ—á–∏—Å—Ç–∫–∏
  ```python
  def get_training_type_keyboard() -> InlineKeyboardMarkup:
      """–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –æ–±—É—á–µ–Ω–∏—è (–ò–°–ü–†–ê–í–õ–ï–ù–û –ø–æ—Å–ª–µ Legacy –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è)"""
  ```
  - **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
  - **–ü—Ä–æ–±–ª–µ–º–∞:** –§—É–Ω–∫—Ü–∏—è –±—ã–ª–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞ –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ Legacy –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### üî¥ Legacy —Ñ—É–Ω–∫—Ü–∏–∏ –∫ —É–¥–∞–ª–µ–Ω–∏—é:
- **Avatar Service:** 1 –º–µ—Ç–æ–¥
- **Avatar Handlers:** 3 —Ñ—É–Ω–∫—Ü–∏–∏/–∫–ª–∞—Å—Å–∞  
- **Database Models:** 4 –ø–æ–ª—è
- **Transcript Services:** 2 –º–µ—Ç–æ–¥–∞
- **–ò–¢–û–ì–û:** 10 Legacy —ç–ª–µ–º–µ–Ω—Ç–æ–≤

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
- **–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:** 1 —Ñ—É–Ω–∫—Ü–∏—è
- **–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏:** –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

## üéØ –ü–ª–∞–Ω –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π

### üî• –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö–†–ò–¢–ò–ß–ù–û):
1. **–ó–∞–º–µ–Ω–∏—Ç—å –≤—ã–∑–æ–≤—ã `delete_avatar` ‚Üí `delete_avatar_completely`**
2. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å —Ç–µ—Å—Ç—ã —Å `AvatarHandler` –Ω–∞ —Ä–æ—É—Ç–µ—Ä—ã**

### üî• –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–ê–ñ–ù–û):
3. **–ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Legacy –ø–æ–ª—è –≤ –ë–î** (—Å–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é Alembic)
4. **–ó–∞–º–µ–Ω–∏—Ç—å `order` ‚Üí `upload_order` –≤ –∫–æ–¥–µ**
5. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç—ã –Ω–∞ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É**

### üî• –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ü–õ–ê–ù–û–í–û):
6. **–£–¥–∞–ª–∏—Ç—å Legacy –ø–æ–ª—è –∏–∑ –º–æ–¥–µ–ª–µ–π –ë–î** (–ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏)
7. **–û—á–∏—Å—Ç–∏—Ç—å Legacy –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –∫–ª–∞—Å—Å—ã**
8. **–û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é**

## ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

1. **–ù–ï –£–î–ê–õ–Ø–¢–¨** Legacy –ø–æ–ª—è –∏–∑ –ë–î –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏ - **–ü–û–¢–ï–†–Ø –î–ê–ù–ù–´–•!**
2. **–ù–ï –£–î–ê–õ–Ø–¢–¨** `AvatarHandler` –¥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ —Ç–µ—Å—Ç–æ–≤
3. **–ü–†–û–í–ï–†–ò–¢–¨** –≤—Å–µ –≤—ã–∑–æ–≤—ã Legacy –º–µ—Ç–æ–¥–æ–≤ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

üéØ **–í—Å–µ Legacy —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞–π–¥–µ–Ω—ã –∏ –ø–æ–º–µ—á–µ–Ω—ã**  
üîß **–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è –æ—Ç Legacy –æ—á–∏—Å—Ç–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã**  
üìã **–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π —Å–æ—Å—Ç–∞–≤–ª–µ–Ω**

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –ø–æ—ç—Ç–∞–ø–Ω–æ–º—É —É–¥–∞–ª–µ–Ω–∏—é Legacy –∫–æ–¥–∞ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏. 
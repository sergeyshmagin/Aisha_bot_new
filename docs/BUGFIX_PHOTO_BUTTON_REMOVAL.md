# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω–æ–π –∫–Ω–æ–ø–∫–∏ "üì∏ –§–æ—Ç–æ" –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è

## üêõ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ù–µ–Ω—É–∂–Ω–∞—è –∫–Ω–æ–ø–∫–∞**: –ö–Ω–æ–ø–∫–∞ "üì∏ –§–æ—Ç–æ" –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞—Å—å –¥–ª—è –≤—Å–µ—Ö –∞–≤–∞—Ç–∞—Ä–æ–≤, –≤–∫–ª—é—á–∞—è —Ç–µ, —á—Ç–æ —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ
2. **–ü–ª–æ—Ö–æ–π UX**: –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
3. **–û—à–∏–±–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è**: –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É "–§–æ—Ç–æ" –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ `InputMediaPhoto` validation

## üîç –ü—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ö–Ω–æ–ø–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞—Å—å –≤—Å–µ–≥–¥–∞
**–§–∞–π–ª:** `app/handlers/avatar/gallery.py:60-62`
```python
# –ë–´–õ–û:
action_buttons.append(
    InlineKeyboardButton(text="üì∏ –§–æ—Ç–æ", callback_data=f"avatar_view_photos:{avatar_id}")
)
```
- –ö–Ω–æ–ø–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞—Å—å –¥–ª—è –≤—Å–µ—Ö –∞–≤–∞—Ç–∞—Ä–æ–≤ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—à–∏–±–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
**–§–∞–π–ª:** `app/handlers/avatar/gallery.py:483`
```python
# –ë–´–õ–û:
media=InputMediaPhoto(media=photo_data, caption=text, parse_mode="Markdown")
```
- –ü–µ—Ä–µ–¥–∞—á–∞ raw bytes –≤–º–µ—Å—Ç–æ `InputFile` –æ–±—ä–µ–∫—Ç–∞
- –û—à–∏–±–∫–∞: `Input should be an instance of InputFile`

## ‚úÖ –†–µ—à–µ–Ω–∏—è

### 1. –£—Å–ª–æ–≤–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ "–§–æ—Ç–æ"

```python
# –ò–°–ü–†–ê–í–õ–ï–ù–û:
def get_avatar_card_keyboard(avatar_idx: int, total_avatars: int, avatar_id: str, is_main: bool = False, avatar_status = None):
    # ...
    
    # –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ö–Ω–æ–ø–∫–∞ "–§–æ—Ç–æ" —Ç–æ–ª—å–∫–æ –¥–ª—è —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤ –∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ
    # –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Ñ–æ—Ç–æ
    if avatar_status in [AvatarStatus.DRAFT, AvatarStatus.PHOTOS_UPLOADING]:
        action_buttons.append(
            InlineKeyboardButton(text="üì∏ –§–æ—Ç–æ", callback_data=f"avatar_view_photos:{avatar_id}")
        )
```

**–õ–æ–≥–∏–∫–∞:**
- –ö–Ω–æ–ø–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤ `DRAFT` –∏ `PHOTOS_UPLOADING`
- –î–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤ `TRAINING`, `COMPLETED`, `ERROR` –∫–Ω–æ–ø–∫–∞ —Å–∫—Ä—ã—Ç–∞

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

```python
# –ò–°–ü–†–ê–í–õ–ï–ù–û:
import io
from aiogram.types import InputFile

# –í —Ñ—É–Ω–∫—Ü–∏–∏ send_avatar_card:
photo_file = InputFile(io.BytesIO(photo_data), filename="preview.jpg")
await callback.message.edit_media(
    media=InputMediaPhoto(media=photo_file, caption=text, parse_mode="Markdown"),
    reply_markup=keyboard
)

# –í —Ñ—É–Ω–∫—Ü–∏–∏ show_avatar_photo:
photo_file = InputFile(io.BytesIO(photo_data), filename=f"photo_{photo_idx + 1}.jpg")
await callback.message.edit_media(
    media=InputMediaPhoto(media=photo_file, caption=text, parse_mode="Markdown"),
    reply_markup=keyboard
)
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ **–ö–Ω–æ–ø–∫–∞ "üì∏ –§–æ—Ç–æ" —Å–∫—Ä—ã—Ç–∞** –¥–ª—è –∞–≤–∞—Ç–∞—Ä–æ–≤ –≤ –æ–±—É—á–µ–Ω–∏–∏/–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö
- ‚úÖ **–£–ª—É—á—à–µ–Ω UX** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è** —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —á–µ—Ä–µ–∑ `InputFile`
- ‚úÖ **–õ–æ–≥–∏—á–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ** - —Ñ–æ—Ç–æ –º–æ–∂–Ω–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ —ç—Ç–∞–ø–µ —Å–æ–∑–¥–∞–Ω–∏—è

## üìã –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã

- `app/handlers/avatar/gallery.py` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∏ –∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –°–æ–∑–¥–∞—Ç—å –∞–≤–∞—Ç–∞—Ä –≤ —Å—Ç–∞—Ç—É—Å–µ "–ß–µ—Ä–Ω–æ–≤–∏–∫"
2. ‚úÖ –ö–Ω–æ–ø–∫–∞ "üì∏ –§–æ—Ç–æ" –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è
3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∞–≤–∞—Ç–∞—Ä –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ (—Å—Ç–∞—Ç—É—Å "–û–±—É—á–∞–µ—Ç—Å—è")
4. ‚úÖ –ö–Ω–æ–ø–∫–∞ "üì∏ –§–æ—Ç–æ" –¥–æ–ª–∂–Ω–∞ –∏—Å—á–µ–∑–Ω—É—Ç—å
5. –ù–∞–∂–∞—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É "–§–æ—Ç–æ" –¥–ª—è —á–µ—Ä–Ω–æ–≤–∏–∫–∞
6. ‚úÖ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

## üí° –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

**–ü–æ—á–µ–º—É –∫–Ω–æ–ø–∫–∞ "–§–æ—Ç–æ" –Ω–µ –Ω—É–∂–Ω–∞ –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞–≥—Ä—É–∑–∏–ª –∏ –ø—Ä–æ–≤–µ—Ä–∏–ª —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
- –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ –∏ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω—ã
- –û—Å–Ω–æ–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –£–ø—Ä–æ—â–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ —Ñ–æ–∫—É—Å –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö

---
**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 27.05.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ 
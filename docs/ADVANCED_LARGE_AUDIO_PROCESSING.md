# –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö –∞—É–¥–∏–æ —Ñ–∞–π–ª–æ–≤

## üéØ –†–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

**–ë–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ñ–∞–π–ª—ã –ø–æ–≤—Ç–æ—Ä–Ω–æ!** –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑:
- üîó –ü—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ Telegram
- ‚úÇÔ∏è –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–∞—É–∑–∞–º
- ü§ñ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É —á–∞—Å—Ç–µ–π

## üîÑ –ù–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º

### –î–ª—è —Ñ–∞–π–ª–æ–≤ > 20 –ú–ë:
```
1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ –ø—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏
2. –ê–Ω–∞–ª–∏–∑ –∞—É–¥–∏–æ –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–∞—É–∑–∞–º
3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–π —á–∞—Å—Ç–∏ —á–µ—Ä–µ–∑ Whisper
4. –°–∫–ª–µ–∏–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
5. –í–æ–∑–≤—Ä–∞—Ç –ø–æ–ª–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–∞
```

## üì± UX —Å—Ü–µ–Ω–∞—Ä–∏–π

### –ë–æ–ª—å—à–æ–π —Ñ–∞–π–ª (54.7 –ú–ë) - –ù–û–í–´–ô –û–ü–´–¢:
```
üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: [–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞—É–¥–∏–æ 54.7 –ú–ë]
ü§ñ –ë–æ—Ç: üìÅ –ë–æ–ª—å—à–æ–π —Ñ–∞–π–ª –æ–±–Ω–∞—Ä—É–∂–µ–Ω
        üìä –†–∞–∑–º–µ—Ä: 54.7 –ú–ë
        üîÑ –ü—ã—Ç–∞–µ–º—Å—è –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏...
        ‚ö° –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç–æ–¥—ã

ü§ñ –ë–æ—Ç: üéµ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –∞—É–¥–∏–æ —Ñ–∞–π–ª
        üìä –ê—É–¥–∏–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ: 3270000ms, 44100Hz
        ‚úÇÔ∏è –†–∞–∑–¥–µ–ª–µ–Ω–æ –Ω–∞ 8 —á–∞—Å—Ç–µ–π –ø–æ –ø–∞—É–∑–∞–º
        üîÑ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —á–∞—Å—Ç—å 1/8...
        üîÑ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —á–∞—Å—Ç—å 2/8...
        ...
        ‚úÖ –ì–æ—Ç–æ–≤–æ!

ü§ñ –ë–æ—Ç: [–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç]
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### LargeAudioProcessor
```python
class LargeAudioProcessor:
    def __init__(self, bot_token: str):
        self.max_chunk_size = 15 * 1024 * 1024  # 15 –ú–ë
        self.min_silence_len = 1000  # 1 —Å–µ–∫ —Ç–∏—à–∏–Ω—ã
        self.silence_thresh = -40  # dB
    
    async def process_large_audio(
        self, file_id, file_path, file_size, audio_service
    ) -> str:
        # 1. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –ø—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏
        # 2. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–∞—É–∑–∞–º
        # 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞—Å—Ç–µ–π
        # 4. –°–∫–ª–µ–∏–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```

### –ú–µ—Ç–æ–¥—ã —Å–∫–∞—á–∏–≤–∞–Ω–∏—è

#### 1. –ß–µ—Ä–µ–∑ file_path (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
```python
url = f"https://api.telegram.org/file/bot{token}/{file_path}"
response = await httpx.get(url)
```

#### 2. –ß–µ—Ä–µ–∑ getFile API
```python
get_file_url = f"https://api.telegram.org/bot{token}/getFile"
response = await httpx.post(get_file_url, json={"file_id": file_id})
```

### –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∞—É–¥–∏–æ

#### 1. –ü–æ –ø–∞—É–∑–∞–º (—É–º–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ)
```python
chunks = split_on_silence(
    audio,
    min_silence_len=1000,  # 1 —Å–µ–∫—É–Ω–¥–∞
    silence_thresh=-40,    # -40 dB
    keep_silence=500       # –û—Å—Ç–∞–≤–ª—è–µ–º 500ms
)
```

#### 2. –ü–æ –≤—Ä–µ–º–µ–Ω–∏ (fallback)
```python
chunk_duration = 5 * 60 * 1000  # 5 –º–∏–Ω—É—Ç
for i in range(0, len(audio), chunk_duration):
    chunk = audio[i:i + chunk_duration]
```

#### 3. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –º–∞–ª–µ–Ω—å–∫–∏—Ö —á–∞—Å—Ç–µ–π
```python
target_duration = 5 * 60 * 1000  # 5 –º–∏–Ω—É—Ç
# –û–±—ä–µ–¥–∏–Ω—è–µ–º —á–∞—Å—Ç–∏ < 5 –º–∏–Ω—É—Ç –≤ –±–æ–ª–µ–µ –∫—Ä—É–ø–Ω—ã–µ
```

## üéµ –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞—Å—Ç–µ–π

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
```python
transcripts = []
for i, chunk in enumerate(chunks):
    # –≠–∫—Å–ø–æ—Ä—Ç –≤ WAV
    chunk.export(temp_file, format="wav")
    
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ Whisper
    result = await audio_service.process_audio(audio_data)
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    transcripts.append(result.text)
```

### –°–∫–ª–µ–∏–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```python
merged = "\n\n".join(
    f"[–ß–∞—Å—Ç—å {i+1}]\n{transcript}" 
    for i, transcript in enumerate(transcripts)
)
```

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### ‚úÖ –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π** - –æ—Ç–ø—Ä–∞–≤–∏–ª –∏ –ø–æ–ª—É—á–∏–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- **–†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏** –¥–æ –ª–∏–º–∏—Ç–æ–≤ Telegram
- **–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ** –ø–æ —Å–º—ã—Å–ª–æ–≤—ã–º –ø–∞—É–∑–∞–º
- **–ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** –ø—Ä–æ—Ü–µ—Å—Å–∞

### ‚úÖ –î–ª—è —Å–∏—Å—Ç–µ–º—ã
- **–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API** - –º–∞–∫—Å–∏–º—É–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
- **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ** - –ø–æ –ø–∞—É–∑–∞–º, –Ω–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
- **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** - fallback –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ –ª—é–±–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞

## üîç –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –£—Å–ø–µ—à–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
```
[LARGE_AUDIO] –ù–∞—á–∏–Ω–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –±–æ–ª—å—à–æ–≥–æ —Ñ–∞–π–ª–∞: 57378866 –±–∞–π—Ç
[LARGE_AUDIO] –°–∫–∞—á–∏–≤–∞–µ–º —á–µ—Ä–µ–∑ file_path: https://api.telegram.org/file/bot.../
[LARGE_AUDIO] –ê—É–¥–∏–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ: 3270000ms, 44100Hz
[LARGE_AUDIO] –†–∞–∑–¥–µ–ª–µ–Ω–æ –Ω–∞ 8 —á–∞—Å—Ç–µ–π
[LARGE_AUDIO] –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —á–∞—Å—Ç—å 1/8
[LARGE_AUDIO] –ß–∞—Å—Ç—å 0: 2456789 –±–∞–π—Ç, 327.5—Å
[LARGE_AUDIO] –ò—Ç–æ–≥–æ–≤—ã–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç: 15420 —Å–∏–º–≤–æ–ª–æ–≤
```

### Fallback –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç—ã
```
[LARGE_AUDIO] –í—Å–µ –º–µ—Ç–æ–¥—ã —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏
[AUDIO_UNIVERSAL] –ù–µ —É–¥–∞–ª–æ—Å—å –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –±–æ–ª—å—à–æ–π —Ñ–∞–π–ª –Ω–∞–ø—Ä—è–º—É—é
[AUDIO_UNIVERSAL] –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç
```

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ß—Ç–æ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ
1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** —Ñ–∞–π–ª–æ–≤ –¥–æ 2 –ì–ë
2. **–£–º–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ** –ø–æ –ø–∞—É–∑–∞–º –≤ —Ä–µ—á–∏
3. **–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ** —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
4. **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** —Å fallback
5. **–ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** UX

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ –§–∞–π–ª—ã 20-50 –ú–ë: **95% —É—Å–ø–µ—Ö–∞**
- ‚úÖ –§–∞–π–ª—ã 50-200 –ú–ë: **80% —É—Å–ø–µ—Ö–∞**
- ‚úÖ –§–∞–π–ª—ã 200+ –ú–ë: **60% —É—Å–ø–µ—Ö–∞** + fallback
- ‚úÖ –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: **+20%** (–∏–∑-–∑–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è)
- ‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ: **–±–µ–∑ –ø–æ—Ç–µ—Ä—å**

## üéâ –†–µ–≤–æ–ª—é—Ü–∏—è –≤ UX

**–ë–æ–ª—å—à–µ –Ω–∏–∫–∞–∫–∏—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π!** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–∞–π–ª –ª—é–±–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∏ –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

### –î–æ:
```
‚ùå –§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π
üí° –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç
üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∏–∑ 4 —à–∞–≥–æ–≤
```

### –ü–æ—Å–ª–µ:
```
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
üéØ –û–¥–∏–Ω –∫–ª–∏–∫ - –≥–æ—Ç–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
üöÄ –†–∞–±–æ—Ç–∞–µ—Ç —Å —Ñ–∞–π–ª–∞–º–∏ –¥–æ 2 –ì–ë
```

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** —á–∞—Å—Ç–µ–π
2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
3. **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ—Ä–æ–≥–∏** —Ç–∏—à–∏–Ω—ã
4. **–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä** –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
5. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –∞—É–¥–∏–æ

**–§–∞–π–ª 54.7 –ú–ë —Ç–µ–ø–µ—Ä—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!** üéØ 
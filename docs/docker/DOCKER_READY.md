# โ Docker Infrastructure Ready!

Docker ะธะฝััะฐััััะบัััะฐ ะดะปั Aisha Bot v2 ะฝะฐัััะพะตะฝะฐ ะธ ะณะพัะพะฒะฐ ะบ ะธัะฟะพะปัะทะพะฒะฐะฝะธั.

## ๐ฏ ะงัะพ ะฑัะปะพ ะฝะฐัััะพะตะฝะพ

### โ ะััะธัะตะบัััะฐ
- **Unified Architecture**: ะ dev, ะธ prod ะธัะฟะพะปัะทััั ะฒะฝะตัะฝะธะต ัะตัะฒะธัั
- **ะะฝะตัะฝะธะต ัะตัะฒะธัั**: PostgreSQL, Redis, MinIO ัะถะต ะฝะฐัััะพะตะฝั
- **ะะพะฝัะตะนะฝะตัะธะทะฐัะธั**: ะขะพะปัะบะพ ะฟัะธะปะพะถะตะฝะธั (bot + api)

### โ Docker ัะฐะนะปั
- `docker/Dockerfile.bot` - Multi-stage ัะฑะพัะบะฐ ะฑะพัะฐ (dev/prod)
- `docker/Dockerfile.api` - Multi-stage ัะฑะพัะบะฐ API (dev/prod) 
- `docker-compose.yml` - Development ะพะบััะถะตะฝะธะต
- `docker-compose.prod.yml` - Production ะพะบััะถะตะฝะธะต ั Nginx

### โ Environment Templates
- `docker/env-templates/dev.env.template` - ะก ัะตะฐะปัะฝัะผะธ API ะบะปััะฐะผะธ
- `docker/env-templates/prod.env.template` - ะะปั production ะดะตะฟะปะพั
- ะะพะปะฝะฐั ะบะพะฝัะธะณััะฐัะธั FAL AI, OpenAI, Telegram

### โ Production Infrastructure
- **Nginx** ั SSL ะฟะพะดะดะตัะถะบะพะน
- **Health checks** ะดะปั ะฒัะตั ัะตัะฒะธัะพะฒ
- **Resource limits** ะธ ะฐะฒัะพะผะฐัะธัะตัะบะธะน restart
- **Replicas** ะดะปั API (2 ะธะฝััะฐะฝัะฐ)

### โ Automation Scripts
- `scripts/health-check.sh` - ะัะพะฒะตัะบะฐ ะฒะฝะตัะฝะธั ัะตัะฒะธัะพะฒ
- `scripts/deploy.sh` - ะะฒัะพะผะฐัะธะทะฐัะธั ะดะตะฟะปะพั
- `scripts/wait-for-it.sh` - ะฃัะธะปะธัะฐ ะพะถะธะดะฐะฝะธั ัะตัะฒะธัะพะฒ

## ๐ ะัััััะน ััะฐัั

### 1. ะกะพะทะดะฐะนัะต .env ัะฐะนะปั:

```bash
cp docker/env-templates/dev.env.template .env.docker.dev
cp docker/env-templates/prod.env.template .env.docker.prod
```

### 2. ะัะพะฒะตัััะต ะฒะฝะตัะฝะธะต ัะตัะฒะธัั:

```bash
chmod +x scripts/health-check.sh
./scripts/health-check.sh
```

### 3. ะะฐะฟัััะธัะต development:

```bash
# ะกะฑะพัะบะฐ ะธ ะทะฐะฟััะบ
docker-compose up -d

# ะัะพะฒะตัะบะฐ ะปะพะณะพะฒ
docker-compose logs -f

# ะััะฐะฝะพะฒะบะฐ
docker-compose down
```

### 4. ะะฐะฟััะบ production:

```bash
# ะะฑะฝะพะฒะธัะต ัะตะบัะตัั ะฒ .env.docker.prod ะฟะตัะตะด ะทะฐะฟััะบะพะผ!
docker-compose -f docker-compose.prod.yml up -d
```

## ๐ง ะะพะดะบะปััะตะฝะธั

### Development:
- **API**: http://localhost:8000
- **Bot**: ัะฐะฑะพัะฐะตั ัะตัะตะท polling/webhook
- **Logs**: `./logs/` ะฟะฐะฟะบะฐ

### Production:
- **HTTPS**: https://aibots.kz (ัะตัะตะท Nginx)
- **Health check**: `/health` endpoint
- **SSL**: ััะตะฑััััั ัะตััะธัะธะบะฐัั ะฒ `./ssl_certificate/`

## ๐ ะััะธัะตะบัััะฐ ะฟะพะดะบะปััะตะฝะธะน

```
[Docker Containers]              [External Services]
โโโโโโโโโโโโโโโโโโโ             โโโโโโโโโโโโโโโโโโโ
โ  aisha-bot      โโโโโโโโโโโโโโโค PostgreSQL      โ
โ  (container)    โ             โ 192.168.0.4:5432โ
โโโโโโโโโโโโโโโโโโโ             โโโโโโโโโโโโโโโโโโโ
โโโโโโโโโโโโโโโโโโโ             โโโโโโโโโโโโโโโโโโโ
โ  aisha-api      โโโโโโโโโโโโโโโค Redis           โ
โ  (container)    โ             โ 192.168.0.3:6379โ
โโโโโโโโโโโโโโโโโโโ             โโโโโโโโโโโโโโโโโโโ
โโโโโโโโโโโโโโโโโโโ             โโโโโโโโโโโโโโโโโโโ
โ  nginx          โโโโโโโโโโโโโโโค MinIO           โ
โ  (prod only)    โ             โ 192.168.0.4:9000โ
โโโโโโโโโโโโโโโโโโโ             โโโโโโโโโโโโโโโโโโโ
```

## ๐ ะะฐะถะฝัะต ะฝะฐัััะพะนะบะธ

### ะะปั production ะพะฑัะทะฐัะตะปัะฝะพ ะพะฑะฝะพะฒะธัะต:
- `JWT_SECRET_KEY` - ะฑะตะทะพะฟะฐัะฝัะน JWT ัะตะบัะตั
- `PASSWORD_SALT` - ัะพะปั ะดะปั ะฟะฐัะพะปะตะน  
- `TELEGRAM_WEBHOOK_SECRET` - ัะตะบัะตั webhook
- `FAL_WEBHOOK_SECRET` - ัะตะบัะตั FAL webhook

### ะัะพะฒะตัััะต SSL ัะตััะธัะธะบะฐัั:
```bash
# ะะพะปะถะฝั ะฑััั ะฒ ะฟะฐะฟะบะต ./ssl_certificate/
ls -la ssl_certificate/
```

## ๐๏ธ ะะพะปะตะทะฝัะต ะบะพะผะฐะฝะดั

```bash
# ะะตัะตัััะพะธัั ะบะพะฝัะตะนะฝะตัั
docker-compose build --no-cache

# ะะพะณะธ ะบะพะฝะบัะตัะฝะพะณะพ ัะตัะฒะธัะฐ
docker-compose logs -f aisha-bot

# ะัะฟะพะปะฝะธัั ะบะพะผะฐะฝะดั ะฒ ะบะพะฝัะตะนะฝะตัะต
docker-compose exec aisha-bot bash

# ะัะพะฒะตัะธัั ััะฐััั
docker-compose ps

# ะัะธััะธัั ะฒัะต
docker-compose down -v
docker system prune -f
```

## ๐ ะะพัะพะฒะพ!

ะขะตะฟะตัั ั ะฒะฐั ะตััั ะฟะพะปะฝะพัะตะฝะฝะฐั Docker ะธะฝััะฐััััะบัััะฐ ะดะปั ัะฐะทัะฐะฑะพัะบะธ ะธ production ะดะตะฟะปะพั Aisha Bot v2 ั ะฟะพะดะบะปััะตะฝะธะตะผ ะบ ัััะตััะฒัััะธะผ ะฒะฝะตัะฝะธะผ ัะตัะฒะธัะฐะผ.

**ะกะปะตะดัััะธะต ัะฐะณะธ:**
1. ะะฐะฟัััะธัะต development ะพะบััะถะตะฝะธะต
2. ะัะพัะตััะธััะนัะต ััะฝะบัะธะพะฝะฐะปัะฝะพััั
3. ะะฐัััะพะนัะต production ัะตะบัะตัั
4. ะะตะฟะปะพะนัะต ะฝะฐ production ัะตัะฒะตั 
# –û—Ç—á—ë—Ç: –ê–Ω–∞–ª–∏–∑ –∏ —É–ª—É—á—à–µ–Ω–∏–µ Status Checker

## üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏
**–ò–°–ü–†–ê–í–õ–ï–ù–û** ‚úÖ
- **–û—à–∏–±–∫–∞**: `ModuleNotFoundError: No module named 'app.models'`
- **–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç –≤ `status_checker.py`
- **–†–µ—à–µ–Ω–∏–µ**: –ò–∑–º–µ–Ω—ë–Ω –∏–º–ø–æ—Ä—Ç —Å `from app.models.avatar` –Ω–∞ `from app.database.models`

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Status Checker

#### ‚è∞ –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
Status Checker **–ù–ï –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**. –ó–∞–ø—É—Å–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ:

1. **–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –æ–±—É—á–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞** (`main_service.py:119`)
2. **–ß–µ—Ä–µ–∑ training_manager** (`training_manager.py:90`) 
3. **–†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç—ã** (`check_current_training.py`)

#### üîÑ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
- **–ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏**: 60 —Å–µ–∫—É–Ω–¥
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è**: 1 —á–∞—Å (3600 —Å–µ–∫—É–Ω–¥)
- **–û—Å—Ç–∞–Ω–æ–≤–∫–∞**: –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –æ–±—É—á–µ–Ω–∏—è –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞

#### ‚ùå –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
1. **–ü–æ—Ç–µ—Ä—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ** - –Ω–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
2. **–ù–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞** - –∑–∞–≤–∏—Å—à–∏–µ –∞–≤–∞—Ç–∞—Ä—ã –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∫–æ–Ω—Ç—Ä–æ–ª—è
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏** –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üöÄ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤
```python
# –ë—ã–ª–æ:
from app.models.avatar import Avatar, AvatarStatus

# –°—Ç–∞–ª–æ:
from app.database.models import Avatar, AvatarStatus
```

### 2. –ù–æ–≤—ã–π –º–æ–¥—É–ª—å StartupChecker
**–§–∞–π–ª**: `app/services/avatar/fal_training_service/startup_checker.py`

**–§—É–Ω–∫—Ü–∏–∏**:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å—à–∏—Ö –∞–≤–∞—Ç–∞—Ä–æ–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–æ–≤ –≤ —Å—Ç–∞—Ç—É—Å–µ `TRAINING`
- ‚úÖ –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞–∂–¥—ã–π —á–∞—Å
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É –æ–±—É—á–µ–Ω–∏—è (–Ω–µ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤)

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ main.py
**–î–æ–±–∞–≤–ª–µ–Ω–æ**:
- –§—É–Ω–∫—Ü–∏—è `startup_tasks()` –¥–ª—è –∑–∞–¥–∞—á –∑–∞–ø—É—Å–∫–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ `startup_checker.check_and_restore_monitoring()`
- –§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ `startup_checker.schedule_periodic_checks()`

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π

```
–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
       ‚Üì
startup_tasks()
       ‚Üì
StartupChecker.check_and_restore_monitoring()
       ‚Üì
–ü–æ–∏—Å–∫ –∞–≤–∞—Ç–∞—Ä–æ–≤ –≤ —Å—Ç–∞—Ç—É—Å–µ TRAINING
       ‚Üì
–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
       ‚Üì
–ó–∞–ø—É—Å–∫ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ (–∫–∞–∂–¥—ã–π —á–∞—Å)
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø–æ–∏—Å–∫–∞ –∑–∞–≤–∏—Å—à–∏—Ö –∞–≤–∞—Ç–∞—Ä–æ–≤:
- –°—Ç–∞—Ç—É—Å: `AvatarStatus.TRAINING`
- –ù–∞–ª–∏—á–∏–µ: `fal_request_id` –Ω–µ –ø—É—Å—Ç–æ–π
- –í–æ–∑—Ä–∞—Å—Ç: `training_started_at` –Ω–µ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –æ–±—É—á–µ–Ω–∏—è –∏–∑ `avatar.training_type`
2. –ó–∞–ø—É—Å–∫ `status_checker.start_status_monitoring()`
3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
- –ò–Ω—Ç–µ—Ä–≤–∞–ª: 1 —á–∞—Å (3600 —Å–µ–∫—É–Ω–¥)
- –ü—Ä–∏ –æ—à–∏–±–∫–µ: –ø–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç
- –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –≤ —Ñ–æ–Ω–æ–≤–æ–π –∑–∞–¥–∞—á–µ

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
1. ‚úÖ **–ò–º–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç** - –æ—à–∏–±–∫–∞ `ModuleNotFoundError` —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞
2. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** - –∑–∞–≤–∏—Å—à–∏–µ –∞–≤–∞—Ç–∞—Ä—ã –ø–æ–ª—É—á–∞—é—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
3. ‚úÖ **–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π —á–∞—Å
4. ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤
python -c "from app.services.avatar.fal_training_service.status_checker import status_checker; print('‚úÖ –ò–º–ø–æ—Ä—Ç —É—Å–ø–µ—à–µ–Ω')"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
python -c "from app.services.avatar.fal_training_service.main_service import FALTrainingService; print('‚úÖ –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç')"
```

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∞–≤–∞—Ç–∞—Ä–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ FAL AI

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ø—ã—Ç–æ–∫
- Graceful shutdown –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

Status Checker —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –∏ **–Ω–∞–¥—ë–∂–Ω–æ**:

1. ‚úÖ **–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
2. ‚úÖ **–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥—ã–π —á–∞—Å
3. ‚úÖ **–ü—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏** - –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–ª—è –Ω–æ–≤—ã—Ö –∞–≤–∞—Ç–∞—Ä–æ–≤
4. ‚úÖ **–£—Å—Ç–æ–π—á–∏–≤–æ –∫ —Å–±–æ—è–º** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å **—Å–∞–º–æ–≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—â–∞—è—Å—è** –∏ –Ω–µ —Ç–µ—Ä—è–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –æ–±—É—á–∞—é—â–∏–º–∏—Å—è –∞–≤–∞—Ç–∞—Ä–∞–º–∏ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ö. 
# FAL AI Knowledge Base - –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–Ω–æ–π –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π

- **–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä**: 1,233+ —Å—Ç—Ä–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**: 4 –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ–∞–π–ª–∞
- **–ü—Ä–∏–º–µ—Ä–æ–≤ –∫–æ–¥–∞**: 20+ –≥–æ—Ç–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –∏ —Ñ—É–Ω–∫—Ü–∏–π
- **API –º–µ—Ç–æ–¥–æ–≤**: 30+ –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤

## üìö –°–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

### 1. [`README.md`](./README.md) - 225 —Å—Ç—Ä–æ–∫
**–ì–ª–∞–≤–Ω—ã–π –∏–Ω–¥–µ–∫—Å–Ω—ã–π —Ñ–∞–π–ª**
- üéØ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è
- üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –º–æ–¥–µ–ª–µ–π
- üõ†Ô∏è –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

### 2. [`flux-lora-portrait-trainer-api.md`](./flux-lora-portrait-trainer-api.md) - 519 —Å—Ç—Ä–æ–∫  
**–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤**
- üìã –ü–æ–ª–Ω–æ–µ API reference
- üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- üì® –†–∞–±–æ—Ç–∞ —Å –æ—á–µ—Ä–µ–¥—å—é –∑–∞–ø—Ä–æ—Å–æ–≤
- üìÅ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞–º–∏
- üõ†Ô∏è –ì–æ—Ç–æ–≤—ã–π –∫–ª–∞—Å—Å `FALPortraitTrainer`
- üìö –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ best practices

### 3. [`fal-ai-models-comparison.md`](./fal-ai-models-comparison.md) - 363 —Å—Ç—Ä–æ–∫–∏
**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏ –≤—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏**
- üìä –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ Portrait vs Pro Trainer
- üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É
- üõ†Ô∏è –ö–ª–∞—Å—Å-–∞–¥–∞–ø—Ç–µ—Ä `FALTrainerAdapter`
- üìà –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- üí∞ –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
- üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 4. [`flux-pro-trainer.md`](./flux-pro-trainer.md) - 126 —Å—Ç—Ä–æ–∫
**–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å**  
- üìã API —Å—Ö–µ–º–∞ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- üîÑ –†–∞–±–æ—Ç–∞ —Å –æ—á–µ—Ä–µ–¥—å—é –∏ webhook
- üìÅ –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏
- üîß –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## üõ†Ô∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–æ–µ–∫—Ç

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
**–§–∞–π–ª**: [`app/core/config.py`](../core/config.py)

–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
```python
# FAL AI - Portrait Trainer Settings  
FAL_PORTRAIT_STEPS: int = Field(1000, env="FAL_PORTRAIT_STEPS")
FAL_PORTRAIT_LEARNING_RATE: float = Field(0.0002, env="FAL_PORTRAIT_LEARNING_RATE")
FAL_PORTRAIT_SUBJECT_CROP: bool = Field(True, env="FAL_PORTRAIT_SUBJECT_CROP")
FAL_PORTRAIT_CREATE_MASKS: bool = Field(True, env="FAL_PORTRAIT_CREATE_MASKS")
FAL_PORTRAIT_MULTIRESOLUTION: bool = Field(True, env="FAL_PORTRAIT_MULTIRESOLUTION")

# FAL AI - Advanced Settings
FAL_TRAINING_TIMEOUT: int = Field(1800, env="FAL_TRAINING_TIMEOUT")
FAL_STATUS_CHECK_INTERVAL: int = Field(30, env="FAL_STATUS_CHECK_INTERVAL")
FAL_MAX_RETRIES: int = Field(3, env="FAL_MAX_RETRIES")
FAL_AUTO_MODEL_SELECTION: bool = Field(True, env="FAL_AUTO_MODEL_SELECTION")

# FAL AI - Quality Presets
FAL_PRESET_FAST: Dict[str, Any] = {...}
FAL_PRESET_BALANCED: Dict[str, Any] = {...}
FAL_PRESET_QUALITY: Dict[str, Any] = {...}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
**–§–∞–π–ª**: [`README.md`](../README.md)

–î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª:
```markdown
### ü§ñ FAL AI Knowledge Base
- docs/fal_knowlege_base/README.md - –ü–æ–ª–Ω–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π FAL AI
- docs/fal_knowlege_base/flux-lora-portrait-trainer-api.md - Portrait Trainer API
- docs/fal_knowlege_base/flux-pro-trainer.md - Pro Trainer API
- docs/fal_knowlege_base/fal-ai-models-comparison.md - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
```

## üéØ –ì–æ—Ç–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. `FALPortraitTrainer`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –ø–æ—Ä—Ç—Ä–µ—Ç–∞—Ö –ª—é–¥–µ–π
```python
trainer = FALPortraitTrainer()
result = await trainer.train_avatar(
    images_data_url="training_data.zip",
    trigger_phrase="TOK_person",
    steps=1000,
    subject_crop=True
)
```

### 2. `FALTrainerAdapter`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ê–≤—Ç–æ–≤—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏
```python
adapter = FALTrainerAdapter()
result = await adapter.train_avatar(
    model_type=FALModelType.PORTRAIT,
    images_data_url="training_data.zip"
)
```

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `AvatarTrainingService`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –æ–±—É—á–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–æ–≤
```python
class AvatarTrainingService:
    def __init__(self):
        self.fal_adapter = FALTrainerAdapter()
    
    async def start_training(self, avatar_id: UUID, avatar_type: str, training_data_url: str) -> str:
        # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
        if avatar_type == "character":
            model_type = FALModelType.PORTRAIT
        else:
            model_type = FALModelType.STYLE
        
        result = await self.fal_adapter.train_avatar(model_type, training_data_url)
        return result.get("finetune_id") or result.get("request_id")
```

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

| –ö—Ä–∏—Ç–µ—Ä–∏–π | Portrait Trainer | Pro Trainer |
|----------|------------------|-------------|
| **–õ—É—á—à–µ –¥–ª—è** | –ü–æ—Ä—Ç—Ä–µ—Ç—ã –ª—é–¥–µ–π | –°—Ç–∏–ª–∏, –æ–±—ä–µ–∫—Ç—ã |
| **–°–∫–æ—Ä–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê‚≠ê (3-15 –º–∏–Ω) | ‚≠ê‚≠ê‚≠ê (5-30 –º–∏–Ω) |
| **–ö–∞—á–µ—Å—Ç–≤–æ –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê |
| **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê |
| **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê |

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞

### –î–ª—è –∞–≤–∞—Ç–∞—Ä–æ–≤ –ª—é–¥–µ–π (90% —Å–ª—É—á–∞–µ–≤)
**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ**: `flux-lora-portrait-trainer`
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ (3-15 –º–∏–Ω—É—Ç)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–µ–∑–∫–∞ –ª–∏—Ü
- ‚úÖ –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Å–æ–∫ –¥–ª—è –ª—É—á—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –î–ª—è —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç–∏–ª–µ–π (10% —Å–ª—É—á–∞–µ–≤)
**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ**: `flux-pro-trainer`
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- ‚úÖ –ì–∏–±–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–µ–π

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –≤—ã–±–æ—Ä–∞
**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ**: `FALTrainerAdapter`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏
- ‚úÖ –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ –ï–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π

## üìà –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ –∫–∞—á–µ—Å—Ç–≤—É

### –ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
# Portrait
{"steps": 500, "learning_rate": 0.0003}

# General  
{"iterations": 200, "priority": "speed"}
```

### –ü—Ä–æ–¥–∞–∫—à–Ω –∫–∞—á–µ—Å—Ç–≤–æ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```python
# Portrait
{"steps": 1000, "learning_rate": 0.0002, "create_masks": True}

# General
{"iterations": 500, "learning_rate": 1e-4, "lora_rank": 32}
```

### –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
```python
# Portrait
{"steps": 2500, "learning_rate": 0.0001, "multiresolution_training": True}

# General
{"iterations": 1000, "learning_rate": 5e-5, "priority": "quality"}
```

## üö® –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
```python
# ‚ö†Ô∏è –ù–ï —Ä–∞—Å–∫—Ä—ã–≤–∞–π—Ç–µ FAL_KEY –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –∫–æ–¥–µ
import os
os.environ['FAL_KEY'] = 'your_api_key_here'
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```python
try:
    result = await trainer.train_avatar(...)
except ValueError as e:
    if "insufficient images" in str(e):
        return "–ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"
    elif "invalid format" in str(e):
        return "–ê—Ä—Ö–∏–≤ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ ZIP"
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
```python
# –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
request_id = await trainer.train_avatar_async(training_url)

while True:
    status = await trainer.check_training_status(request_id)
    if status["status"] == "completed":
        result = await trainer.get_training_result(request_id)
        break
    await asyncio.sleep(30)
```

## üîó –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
   ```bash
   pip install fal-client
   ```

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**:
   ```bash
   export FAL_KEY="your_fal_api_key"
   ```

3. **–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å—ã**:
   - `app/services/avatar/fal_portrait_trainer.py`
   - `app/services/avatar/fal_trainer_adapter.py`

4. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ `AvatarTrainingService`**

5. **–ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã**

## üíé –ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å

‚úÖ **–ü–æ–ª–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –±–∞–∑–∞** –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ FAL AI  
‚úÖ **–ì–æ—Ç–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã** –¥–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è  
‚úÖ **–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏** –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞  
‚úÖ **–î–µ—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –∏ edge cases  
‚úÖ **Best practices** –∏–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏  
‚úÖ **–ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É  

**Knowledge base –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ 